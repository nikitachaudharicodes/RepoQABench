{
  "repo_name": "oppia_oppia",
  "issue_id": "20197",
  "issue_description": "# [BUG]: 404 Not Found error on valid collection player page.\n\n### Describe the bug\r\n\r\nWhen I visit a valid collection player page, I get a 404 Not Found error.\r\n\r\n### URL of the page where the issue is observed.\r\n\r\n/collection/<collection>\r\n\r\n### Steps To Reproduce\r\n\r\n1. Create a new collection (need collection editor rights).\r\n2. Create/add a exploration to the collection and publish it.\r\n3. Go to the collection player of that collection.\r\n\r\n### Expected Behavior\r\n\r\nI expect there to be no 404 Not Found error.\r\n\r\n### Screenshots/Videos\r\n\r\n![Screenshot 2024-04-22 135125](https://github.com/oppia/oppia/assets/70992422/6b73d82e-8464-4e70-8a9f-fc58287c4a75)\r\n\r\n\r\n### What device are you using?\r\n\r\nDesktop\r\n\r\n### Operating System\r\n\r\nWindows\r\n\r\n### What browsers are you seeing the problem on?\r\n\r\nChrome\r\n\r\n### Browser version\r\n\r\n_No response_\r\n\r\n### Additional context\r\nThe other parameter \"key\" error is a different issue which I filed here: #20198.\r\n\r\n### Tips for developers\r\n\r\nBefore addressing the bug, please identify which PR caused the issue (you can follow the steps [here](https://github.com/oppia/oppia/wiki/How-to-find-the-commit-which-introduced-a-bug)). If you identify the PR, comment on the issue with a link to it. If not, mention the commit hash of the oldest commit you saw the bug on (and the month and year it was made in).\r\n\r\nThen, please leave a comment with details of the approach that you plan to take to fix the issue (see [example](https://github.com/oppia/oppia/issues/19157#issuecomment-1858788463)).\r\n\r\n**Note:** If this is your first Oppia issue, please make sure to follow our guidelines for [choosing an issue](https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#choosing-a-good-first-issue) and [setting things up](https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#setting-things-up). You will also need to show a demo of the fix working correctly on your local machine. Thanks!\r\n",
  "issue_comments": [
    {
      "id": 2469670603,
      "user": "yashdarekar17",
      "body": "To simulate and debug error handling, it might be want to modify the mock service to reject under certain conditions:\r\nat file collection-player-auth.gurad.spec.ts\r\nclass MockAccessValidationBackendApiService {\r\n  validateAccessToCollectionPlayerPage(collectionId: string) {\r\n    // Simulate a 404 error if a specific condition is met\r\n    if (!collectionId || collectionId === \"invalid-id\") {\r\n      return Promise.reject(new Error(\"404: Collection Not Found\"));\r\n    }\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\r\n"
    },
    {
      "id": 2477880837,
      "user": "yashdarekar17",
      "body": "Pls reply me\n"
    },
    {
      "id": 2480761745,
      "user": "HardikGoyal2003",
      "body": "Hey, @yashdarekar17 Sorry for the late response, first can you check if you are able to reproduce this issue on devserver?"
    },
    {
      "id": 2488112884,
      "user": "ParagGhatage",
      "body": "Hey @HardikGoyal2003,\r\nI can take this issue. Let me know if that works."
    },
    {
      "id": 2488147411,
      "user": "HardikGoyal2003",
      "body": "Hey @ParagGhatage  Per the guidance at https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#choosing-a-good-first-issue, please provide an explanation of what your PR will do (with names of files you're changing, what you plan to change in each file, etc.). If it looks good, we can assign you to this issue.\r\n\r\nPlease also follow the other instructions on that wiki page if you have not yet done so. Thanks!\r\n\r\nPlease can you also check if you are able to reproduce this issue on the devserver?"
    },
    {
      "id": 2490448439,
      "user": "ParagGhatage",
      "body": "Hey @HardikGoyal2003 ,\r\n\r\nTo reproduce this issue, @jnvtnguyen  provided these steps:\r\n\r\n         Create a new collection (requires collection editor rights).\r\n         Add an exploration to the collection and publish it.\r\n         Visit the collection player page for that collection.\r\n   \r\n  I’m a bit unclear on the exact problem.\r\n  Is the issue about:\r\n          Collections not being displayed after being added?\r\n          Or is it specifically about a broken URL leading to a 404 error?\r\n          \r\nAlso, could you clarify how I can add a collection and obtain the URL for the collection player page to properly test this? Would I need to add a dummy collection in the code or test it directly on the actual running website?"
    },
    {
      "id": 2490723051,
      "user": "ParagGhatage",
      "body": "@jnvtnguyen ,\r\nWhat's Expected Behavior here?\r\nCan you clarify a bit?"
    },
    {
      "id": 2507639261,
      "user": "HardikGoyal2003",
      "body": "Hey @ParagGhatage Apologies for the late response, \r\n\r\n>Is the issue about:\r\n>Collections not being displayed after being added?\r\n>Or is it specifically about a broken URL leading to a 404 error?\r\n\r\nI think the problem is that the collection is loading properly, but the console gives a 404 error, but once you need to try reproducing this error first.\r\n\r\n>Also, could you clarify how I can add a collection and obtain the URL for the collection player page to properly test this?\r\n\r\n- Assign yourself the collection editor role from the admin page.\r\n- Create 2-3 explorations.\r\n- Access the creator dashboard and create a new collection.\r\n- Add the explorations to the collection.\r\n- Open the collection player for that collection.\r\n\r\n>Would I need to add a dummy collection in the code or test it directly on the actual running website?\r\nYou need to test it on the local dev server and generate the data manually first.\r\n\r\n> What's Expected Behavior here?\r\n\r\nNo console error should be there and the collection player should work properly. \r\n\r\nThanks!!\r\n\r\n\r\n\r\n\r\n\r\n\r\n"
    },
    {
      "id": 2510829364,
      "user": "ParagGhatage",
      "body": "> Hey @ParagGhatage Apologies for the late response,\r\n> \r\n> > Is the issue about:\r\n> > Collections not being displayed after being added?\r\n> > Or is it specifically about a broken URL leading to a 404 error?\r\n> \r\n> I think the problem is that the collection is loading properly, but the console gives a 404 error, but once you need to try reproducing this error first.\r\n> \r\n> > Also, could you clarify how I can add a collection and obtain the URL for the collection player page to properly test this?\r\n> \r\n> * Assign yourself the collection editor role from the admin page.\r\n> * Create 2-3 explorations.\r\n> * Access the creator dashboard and create a new collection.\r\n> * Add the explorations to the collection.\r\n> * Open the collection player for that collection.\r\n> \r\n> > Would I need to add a dummy collection in the code or test it directly on the actual running website?\r\n> > You need to test it on the local dev server and generate the data manually first.\r\n> \r\n> > What's Expected Behavior here?\r\n> \r\n> No console error should be there and the collection player should work properly.\r\n> \r\n> Thanks!!\r\n\r\nThanks for explaining.\r\nI will start working on this issue shortly.\r\n"
    },
    {
      "id": 2567131056,
      "user": "gurramkarthiknetha",
      "body": "If no one is currently working on this issue, I would like to take it on. Please assign it to me\r\n"
    },
    {
      "id": 2567132900,
      "user": "HardikGoyal2003",
      "body": "Hey @gurramkarthiknetha  Per the guidance at https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#choosing-a-good-first-issue, please provide an explanation of what your PR will do (with names of files you're changing, what you plan to change in each file, etc.). If it looks good, we can assign you to this issue.\r\n\r\nPlease also follow the other instructions on that wiki page if you have not yet done so. Thanks!"
    },
    {
      "id": 2612030942,
      "user": "shwetd19",
      "body": "Hey @HardikGoyal2003 \n\nHi, I can help explain my planned approach for fixing this 404 error issue:\n\nKey files to modify:\n1. `collection-player-auth.guard.ts`: Update error handling in the route guard to properly handle collection validation failures\n2. `collection-player.component.ts`: Add error state handling for invalid/missing collections\n\nPlanned changes:\n- Add proper error catching in the auth guard's `canActivate()` method\n- Implement graceful fallback when collection validation fails\n- Add unit tests to verify error handling in `collection-player-auth.guard.spec.ts`\n\nI'll first reproduce the issue locally by:\n1. Setting up collection editor access\n2. Creating test explorations and collections\n3. Verifying the 404 error occurs on collection player page\n\nWould this approach work? I can elaborate on any part of the implementation plan.\n\nLet me know if you'd like me to proceed with these changes would love to take this issue on!\n\nThanks!"
    },
    {
      "id": 2612049775,
      "user": "HardikGoyal2003",
      "body": "@shwetd19 Can you first show if this issue is reproducible? If it is reproducible, please mention the lines of code you will be changing, and a video demo that, it fixes the issue. Thanks!"
    },
    {
      "id": 2704217638,
      "user": "HardikGoyal2003",
      "body": "This is due to the improper migration of the collection page,\n\nTo fix this issue, the route also needs to be registered as a backend route in [main.py](https://github.com/oppia/oppia/blob/develop/main.py#L1231)"
    },
    {
      "id": 2727541223,
      "user": "HardikGoyal2003",
      "body": "Closing this as fixed by https://github.com/oppia/oppia/pull/22081"
    }
  ],
  "text_context": "# [BUG]: 404 Not Found error on valid collection player page.\n\n### Describe the bug\r\n\r\nWhen I visit a valid collection player page, I get a 404 Not Found error.\r\n\r\n### URL of the page where the issue is observed.\r\n\r\n/collection/<collection>\r\n\r\n### Steps To Reproduce\r\n\r\n1. Create a new collection (need collection editor rights).\r\n2. Create/add a exploration to the collection and publish it.\r\n3. Go to the collection player of that collection.\r\n\r\n### Expected Behavior\r\n\r\nI expect there to be no 404 Not Found error.\r\n\r\n### Screenshots/Videos\r\n\r\n![Screenshot 2024-04-22 135125](https://github.com/oppia/oppia/assets/70992422/6b73d82e-8464-4e70-8a9f-fc58287c4a75)\r\n\r\n\r\n### What device are you using?\r\n\r\nDesktop\r\n\r\n### Operating System\r\n\r\nWindows\r\n\r\n### What browsers are you seeing the problem on?\r\n\r\nChrome\r\n\r\n### Browser version\r\n\r\n_No response_\r\n\r\n### Additional context\r\nThe other parameter \"key\" error is a different issue which I filed here: #20198.\r\n\r\n### Tips for developers\r\n\r\nBefore addressing the bug, please identify which PR caused the issue (you can follow the steps [here](https://github.com/oppia/oppia/wiki/How-to-find-the-commit-which-introduced-a-bug)). If you identify the PR, comment on the issue with a link to it. If not, mention the commit hash of the oldest commit you saw the bug on (and the month and year it was made in).\r\n\r\nThen, please leave a comment with details of the approach that you plan to take to fix the issue (see [example](https://github.com/oppia/oppia/issues/19157#issuecomment-1858788463)).\r\n\r\n**Note:** If this is your first Oppia issue, please make sure to follow our guidelines for [choosing an issue](https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#choosing-a-good-first-issue) and [setting things up](https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#setting-things-up). You will also need to show a demo of the fix working correctly on your local machine. Thanks!\r\n\n\nTo simulate and debug error handling, it might be want to modify the mock service to reject under certain conditions:\r\nat file collection-player-auth.gurad.spec.ts\r\nclass MockAccessValidationBackendApiService {\r\n  validateAccessToCollectionPlayerPage(collectionId: string) {\r\n    // Simulate a 404 error if a specific condition is met\r\n    if (!collectionId || collectionId === \"invalid-id\") {\r\n      return Promise.reject(new Error(\"404: Collection Not Found\"));\r\n    }\r\n    return Promise.resolve();\r\n  }\r\n}\r\n\r\n\n\nPls reply me\n\n\nHey, @yashdarekar17 Sorry for the late response, first can you check if you are able to reproduce this issue on devserver?\n\nHey @HardikGoyal2003,\r\nI can take this issue. Let me know if that works.\n\nHey @ParagGhatage  Per the guidance at https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#choosing-a-good-first-issue, please provide an explanation of what your PR will do (with names of files you're changing, what you plan to change in each file, etc.). If it looks good, we can assign you to this issue.\r\n\r\nPlease also follow the other instructions on that wiki page if you have not yet done so. Thanks!\r\n\r\nPlease can you also check if you are able to reproduce this issue on the devserver?\n\nHey @HardikGoyal2003 ,\r\n\r\nTo reproduce this issue, @jnvtnguyen  provided these steps:\r\n\r\n         Create a new collection (requires collection editor rights).\r\n         Add an exploration to the collection and publish it.\r\n         Visit the collection player page for that collection.\r\n   \r\n  I’m a bit unclear on the exact problem.\r\n  Is the issue about:\r\n          Collections not being displayed after being added?\r\n          Or is it specifically about a broken URL leading to a 404 error?\r\n          \r\nAlso, could you clarify how I can add a collection and obtain the URL for the collection player page to properly test this? Would I need to add a dummy collection in the code or test it directly on the actual running website?\n\n@jnvtnguyen ,\r\nWhat's Expected Behavior here?\r\nCan you clarify a bit?\n\nHey @ParagGhatage Apologies for the late response, \r\n\r\n>Is the issue about:\r\n>Collections not being displayed after being added?\r\n>Or is it specifically about a broken URL leading to a 404 error?\r\n\r\nI think the problem is that the collection is loading properly, but the console gives a 404 error, but once you need to try reproducing this error first.\r\n\r\n>Also, could you clarify how I can add a collection and obtain the URL for the collection player page to properly test this?\r\n\r\n- Assign yourself the collection editor role from the admin page.\r\n- Create 2-3 explorations.\r\n- Access the creator dashboard and create a new collection.\r\n- Add the explorations to the collection.\r\n- Open the collection player for that collection.\r\n\r\n>Would I need to add a dummy collection in the code or test it directly on the actual running website?\r\nYou need to test it on the local dev server and generate the data manually first.\r\n\r\n> What's Expected Behavior here?\r\n\r\nNo console error should be there and the collection player should work properly. \r\n\r\nThanks!!\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n> Hey @ParagGhatage Apologies for the late response,\r\n> \r\n> > Is the issue about:\r\n> > Collections not being displayed after being added?\r\n> > Or is it specifically about a broken URL leading to a 404 error?\r\n> \r\n> I think the problem is that the collection is loading properly, but the console gives a 404 error, but once you need to try reproducing this error first.\r\n> \r\n> > Also, could you clarify how I can add a collection and obtain the URL for the collection player page to properly test this?\r\n> \r\n> * Assign yourself the collection editor role from the admin page.\r\n> * Create 2-3 explorations.\r\n> * Access the creator dashboard and create a new collection.\r\n> * Add the explorations to the collection.\r\n> * Open the collection player for that collection.\r\n> \r\n> > Would I need to add a dummy collection in the code or test it directly on the actual running website?\r\n> > You need to test it on the local dev server and generate the data manually first.\r\n> \r\n> > What's Expected Behavior here?\r\n> \r\n> No console error should be there and the collection player should work properly.\r\n> \r\n> Thanks!!\r\n\r\nThanks for explaining.\r\nI will start working on this issue shortly.\r\n\n\nIf no one is currently working on this issue, I would like to take it on. Please assign it to me\r\n\n\nHey @gurramkarthiknetha  Per the guidance at https://github.com/oppia/oppia/wiki/Contributing-code-to-Oppia#choosing-a-good-first-issue, please provide an explanation of what your PR will do (with names of files you're changing, what you plan to change in each file, etc.). If it looks good, we can assign you to this issue.\r\n\r\nPlease also follow the other instructions on that wiki page if you have not yet done so. Thanks!\n\nHey @HardikGoyal2003 \n\nHi, I can help explain my planned approach for fixing this 404 error issue:\n\nKey files to modify:\n1. `collection-player-auth.guard.ts`: Update error handling in the route guard to properly handle collection validation failures\n2. `collection-player.component.ts`: Add error state handling for invalid/missing collections\n\nPlanned changes:\n- Add proper error catching in the auth guard's `canActivate()` method\n- Implement graceful fallback when collection validation fails\n- Add unit tests to verify error handling in `collection-player-auth.guard.spec.ts`\n\nI'll first reproduce the issue locally by:\n1. Setting up collection editor access\n2. Creating test explorations and collections\n3. Verifying the 404 error occurs on collection player page\n\nWould this approach work? I can elaborate on any part of the implementation plan.\n\nLet me know if you'd like me to proceed with these changes would love to take this issue on!\n\nThanks!\n\n@shwetd19 Can you first show if this issue is reproducible? If it is reproducible, please mention the lines of code you will be changing, and a video demo that, it fixes the issue. Thanks!\n\nThis is due to the improper migration of the collection page,\n\nTo fix this issue, the route also needs to be registered as a backend route in [main.py](https://github.com/oppia/oppia/blob/develop/main.py#L1231)\n\nClosing this as fixed by https://github.com/oppia/oppia/pull/22081",
  "pr_link": "https://github.com/oppia/oppia/pull/22081",
  "code_context": [
    {
      "filename": "main.py",
      "content": "# Copyright 2014 The Oppia Authors. All Rights Reserved.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS-IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\n\"\"\"URL routing definitions, and some basic error/warmup handlers.\"\"\"\n\nfrom __future__ import annotations\n\nimport logging\n\nfrom core import android_validation_constants\nfrom core import feconf\nfrom core.constants import constants\nfrom core.controllers import access_validators\nfrom core.controllers import acl_decorators\nfrom core.controllers import admin\nfrom core.controllers import android\nfrom core.controllers import base\nfrom core.controllers import beam_jobs\nfrom core.controllers import blog_admin\nfrom core.controllers import blog_dashboard\nfrom core.controllers import blog_homepage\nfrom core.controllers import classroom\nfrom core.controllers import collection_editor\nfrom core.controllers import collection_viewer\nfrom core.controllers import concept_card_viewer\nfrom core.controllers import contributor_dashboard\nfrom core.controllers import contributor_dashboard_admin\nfrom core.controllers import creator_dashboard\nfrom core.controllers import cron\nfrom core.controllers import custom_landing_pages\nfrom core.controllers import diagnostic_test_player\nfrom core.controllers import editor\nfrom core.controllers import email_dashboard\nfrom core.controllers import feature_flag\nfrom core.controllers import features\nfrom core.controllers import feedback\nfrom core.controllers import feedback_updates\nfrom core.controllers import firebase\nfrom core.controllers import improvements\nfrom core.controllers import incoming_app_feedback_report\nfrom core.controllers import learner_dashboard\nfrom core.controllers import learner_goals\nfrom core.controllers import learner_group\nfrom core.controllers import learner_playlist\nfrom core.controllers import library\nfrom core.controllers import moderator\nfrom core.controllers import oppia_root\nfrom core.controllers import pages\nfrom core.controllers import practice_sessions\nfrom core.controllers import profile\nfrom core.controllers import question_editor\nfrom core.controllers import questions_list\nfrom core.controllers import reader\nfrom core.controllers import recent_commits\nfrom core.controllers import release_coordinator\nfrom core.controllers import resources\nfrom core.controllers import review_tests\nfrom core.controllers import skill_editor\nfrom core.controllers import skill_mastery\nfrom core.controllers import story_editor\nfrom core.controllers import story_viewer\nfrom core.controllers import subscriptions\nfrom core.controllers import subtopic_viewer\nfrom core.controllers import suggestion\nfrom core.controllers import tasks\nfrom core.controllers import topic_editor\nfrom core.controllers import topic_viewer\nfrom core.controllers import topics_and_skills_dashboard\nfrom core.controllers import voice_artist\nfrom core.controllers import voiceover\nfrom core.platform import models\nfrom core.platform.auth import firebase_auth_services\n\nimport google.cloud.logging\nfrom typing import Dict, Optional, Type, TypeVar\nimport webapp2\nfrom webapp2_extras import routes\n\nMYPY = False\nif MYPY:  # pragma: no cover\n    from mypy_imports import datastore_services\n    from mypy_imports import memory_cache_services as cache_services\n\nT = TypeVar('T')  # pylint: disable=invalid-name\n\ncache_services = models.Registry.import_cache_services()\ndatastore_services = models.Registry.import_datastore_services()\n\n# Cloud Logging is disabled in emulator mode, since it is unnecessary and\n# creates a lot of noise.\nif not constants.EMULATOR_MODE:\n    # Instantiates a client and retrieves a Cloud Logging handler based on the\n    # environment you're running in and integrates the handler with the Python\n    # logging module.\n    client = google.cloud.logging.Client()\n    client.setup_logging()\n\n# Suppress debug logging for chardet. See https://stackoverflow.com/a/48581323.\n# Without this, a lot of unnecessary debug logs are printed in error logs,\n# which makes it tiresome to identify the actual error.\nlogging.getLogger(name='chardet.charsetprober').setLevel(logging.INFO)\n\n\nclass InternetConnectivityHandler(\n    base.BaseHandler[Dict[str, str], Dict[str, str]]\n):\n    \"\"\"Handles the get request to the server from the\n    frontend to check for internet connection.\"\"\"\n\n    GET_HANDLER_ERROR_RETURN_TYPE = feconf.HANDLER_TYPE_JSON\n    URL_PATH_ARGS_SCHEMAS: Dict[str, str] = {}\n    HANDLER_ARGS_SCHEMAS: Dict[str, Dict[str, str]] = {'GET': {}}\n\n    @acl_decorators.open_access\n    def get(self) -> None:\n        \"\"\"Handles GET requests.\"\"\"\n        self.render_json({'is_internet_connected': True})\n\n\nclass FrontendErrorHandler(\n    base.BaseHandler[Dict[str, str], Dict[str, str]]\n):\n    \"\"\"Handles errors arising from the frontend.\"\"\"\n\n    REQUIRE_PAYLOAD_CSRF_CHECK = False\n    URL_PATH_ARGS_SCHEMAS: Dict[str, str] = {}\n    HANDLER_ARGS_SCHEMAS = {\n        'POST': {\n            'error': {\n                'schema': {\n                    'type': 'basestring'\n                }\n            }\n        }\n    }\n\n    @acl_decorators.open_access\n    def post(self) -> None:\n        \"\"\"Records errors reported by the frontend.\"\"\"\n        assert self.normalized_payload is not None\n        logging.error(\n            'Frontend error: %s' % self.normalized_payload.get('error')\n        )\n        self.render_json(self.values)\n\n\nclass WarmupPage(\n    base.BaseHandler[Dict[str, str], Dict[str, str]]\n):\n    \"\"\"Handles warmup requests.\"\"\"\n\n    GET_HANDLER_ERROR_RETURN_TYPE = feconf.HANDLER_TYPE_HTML\n    URL_PATH_ARGS_SCHEMAS: Dict[str, str] = {}\n    HANDLER_ARGS_SCHEMAS: Dict[str, Dict[str, str]] = {'GET': {}}\n\n    @acl_decorators.open_access\n    def get(self) -> None:\n        \"\"\"Handles GET warmup requests.\"\"\"\n        pass\n\n\nclass SplashRedirectPage(\n    base.BaseHandler[Dict[str, str], Dict[str, str]]\n):\n    \"\"\"Redirect the old splash URL, '/splash' to the new one, '/'.\"\"\"\n\n    GET_HANDLER_ERROR_RETURN_TYPE = feconf.HANDLER_TYPE_HTML\n    URL_PATH_ARGS_SCHEMAS: Dict[str, str] = {}\n    HANDLER_ARGS_SCHEMAS: Dict[str, Dict[str, str]] = {'GET': {}}\n\n    @acl_decorators.open_access\n    def get(self) -> None:\n        self.redirect('/')\n\n\n# Type for `defaults` is set to Dict[str, str] based on the usage in our\n# backend. Should be changed in future as per the requirements.\ndef get_redirect_route(\n        regex_route: str,\n        handler: Type[webapp2.RequestHandler],\n        defaults: Optional[Dict[str, str]] = None\n) -> routes.RedirectRoute:\n    \"\"\"Returns a route that redirects /foo/ to /foo.\n\n    Warning: this method strips off parameters after the trailing slash. URLs\n    with parameters should be formulated without the trailing slash.\n\n    Args:\n        regex_route: unicode. A raw string representing a route.\n        handler: RequestHandler. A callable to handle the route.\n        defaults: dict. Optional defaults parameter to be passed\n            into the RedirectRoute object.\n\n    Returns:\n        RedirectRoute. A RedirectRoute object for redirects.\n    \"\"\"\n    if defaults is None:\n        defaults = {}\n    name = regex_route.replace('/', '_')\n    return routes.RedirectRoute(\n        regex_route, handler, name, strict_slash=True, defaults=defaults)\n\n\n# Register the URLs with the classes responsible for handling them.\nURLS = [\n    get_redirect_route(\n        '/<firebase_path:__/auth(?:/.*)?>',\n        firebase.FirebaseProxyPage\n    ),\n    get_redirect_route(r'/_ah/warmup', WarmupPage),\n    get_redirect_route(r'/splash', SplashRedirectPage),\n    get_redirect_route(\n        r'/internetconnectivityhandler', InternetConnectivityHandler),\n    get_redirect_route(r'/credits', pages.AboutRedirectPage),\n    get_redirect_route(r'/participate', pages.TeachRedirectPage),\n    get_redirect_route(r'/site_guidelines', pages.TeachRedirectPage),\n\n    get_redirect_route(r'/forum', pages.ForumRedirectPage),\n\n    # Access Validators.\n    get_redirect_route(\n        r'%s/can_access_classroom_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ClassroomAccessValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_classrooms_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ClassroomsPageAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_collection_editor_page/<collection_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.CollectionEditorAccessValidationPage\n    ),\n     get_redirect_route(\n        r'%s/can_access_exploration_editor_page/<exploration_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ExplorationEditorAccessValidationHandlerPage\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_story_editor_page/<story_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.StoryEditorAccessValidationHandlerPage\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_blog_home_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.BlogHomePageAccessValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_subtopic_viewer_page/<classroom_url_fragment>/<topic_url_fragment>/revision/<subtopic_url_fragment>' % # pylint: disable=line-too-long\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.SubtopicViewerPageAccessValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_blog_post_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.BlogPostPageAccessValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_blog_author_profile_page/<author_username>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.BlogAuthorProfilePageAccessValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_manage_own_account' % feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ManageOwnAccountValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_topic_editor/<topic_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.TopicEditorAccessValidationPage\n    ),\n\n    get_redirect_route(\n        r'%s/does_profile_exist/<username>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ProfileExistsValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_release_coordinator_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ReleaseCoordinatorAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_facilitator_dashboard_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.FacilitatorDashboardPageAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_create_learner_group_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.CreateLearnerGroupPageAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_edit_learner_group_page/<learner_group_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.EditLearnerGroupPageAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/does_learner_group_exist/<learner_group_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ViewLearnerGroupPageAccessValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_collection_player_page/<collection_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.CollectionViewerPageAccessValidationHandler),\n\n    get_redirect_route(\n        r'%s/can_access_diagnostic_test_player_page' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.DiagnosticTestPlayerAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_practice_session_page/<classroom_url_fragment>'\n        r'/<topic_url_fragment>/practice/session' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.PracticeSessionAccessValidationPage\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_topic_viewer_page/<classroom_url_fragment>'\n        r'/<topic_url_fragment>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.TopicViewerPageAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_topic_viewer_page/<classroom_url_fragment>'\n        r'/<topic_url_fragment>/story' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.TopicViewerPageAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_topic_viewer_page/<classroom_url_fragment>'\n        r'/<topic_url_fragment>/revision' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.TopicViewerPageAccessValidationHandler\n    ),\n\n    get_redirect_route(\n        r'%s/can_access_topic_viewer_page/<classroom_url_fragment>'\n        r'/<topic_url_fragment>/practice' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.TopicViewerPageAccessValidationHandler\n    ),\n\n    get_redirect_route(r'%s' % feconf.ADMIN_URL, oppia_root.OppiaRootPage),\n    get_redirect_route(r'/adminhandler', admin.AdminHandler),\n    get_redirect_route(r'/adminrolehandler', admin.AdminRoleHandler),\n    get_redirect_route(r'/bannedusershandler', admin.BannedUsersHandler),\n    get_redirect_route(\n        r'/topicmanagerrolehandler', admin.TopicManagerRoleHandler),\n    get_redirect_route(\n        r'/translationcoordinatorrolehandler',\n        admin.TranslationCoordinatorRoleHandler),\n    get_redirect_route(\n        r'/adminsuperadminhandler', admin.AdminSuperAdminPrivilegesHandler),\n    get_redirect_route(\n        r'/admintopicscsvdownloadhandler',\n        admin.AdminTopicsCsvFileDownloader),\n    get_redirect_route(\n        r'%s' % feconf.AUTOMATIC_VOICEOVER_ADMIN_CONTROL_URL,\n        admin.AutomaticVoiceoverAdminControlHandler\n    ),\n    get_redirect_route(\n        r'/updateblogpostdatahandler', admin.UpdateBlogPostHandler),\n    get_redirect_route(\n        r'%s' % feconf.REGENERATE_TOPIC_SUMMARIES_URL,\n        admin.RegenerateTopicSummariesHandler),\n    get_redirect_route(\n        r'/contributionrightshandler/<category>',\n        contributor_dashboard_admin.ContributionRightsHandler),\n    get_redirect_route(\n        r'/getcontributorusershandler/<category>',\n        contributor_dashboard_admin.ContributorUsersListHandler),\n    get_redirect_route(\n        r'/contributionrightsdatahandler',\n        contributor_dashboard_admin.ContributionRightsDataHandler),\n    get_redirect_route(\n        r'%s/<contribution_type>/<contribution_subtype>' % (\n            feconf.CONTRIBUTOR_DASHBOARD_ADMIN_STATS_URL_PREFIX),\n        contributor_dashboard_admin.ContributorDashboardAdminStatsHandler),\n    get_redirect_route(\n        r'%s' % (feconf.COMMUNITY_CONTRIBUTION_STATS_URL),\n        contributor_dashboard_admin.CommunityContributionStatsHandler),\n    get_redirect_route(\n        r'/translationcontributionstatshandler',\n        contributor_dashboard_admin.TranslationContributionStatsHandler),\n    get_redirect_route(\n        r'%s/<contribution_type>/<contribution_subtype>/<username>' % (\n            feconf.CONTRIBUTOR_STATS_SUMMARIES_URL),\n        contributor_dashboard.ContributorStatsSummariesHandler),\n    get_redirect_route(\n        r'%s/<username>' % feconf.CONTRIBUTOR_ALL_STATS_SUMMARIES_URL,\n        contributor_dashboard.ContributorAllStatsSummariesHandler),\n    get_redirect_route(\n        r'%s/<username>/<suggestion_type>' % (\n            feconf.CONTRIBUTOR_CERTIFICATE_URL),\n        contributor_dashboard.ContributorCertificateHandler),\n    get_redirect_route(\n        '/contributor_dashboard',\n        creator_dashboard.OldContributorDashboardRedirectPage),\n    get_redirect_route(\n        '/creator_dashboard',\n        creator_dashboard.OldCreatorDashboardRedirectPage),\n    get_redirect_route(\n        r'%s' % feconf.CREATOR_DASHBOARD_DATA_URL,\n        creator_dashboard.CreatorDashboardHandler),\n    get_redirect_route(\n        r'%s' % feconf.NEW_EXPLORATION_URL,\n        creator_dashboard.NewExplorationHandler),\n    get_redirect_route(\n        r'%s' % feconf.NEW_COLLECTION_URL,\n        creator_dashboard.NewCollectionHandler),\n    get_redirect_route(\n        r'%s' % feconf.FRACTIONS_LANDING_PAGE_URL,\n        custom_landing_pages.FractionLandingRedirectPage),\n    get_redirect_route(\n        r'/learn/maths/<topic>', custom_landing_pages.TopicLandingRedirectPage),\n    get_redirect_route(\n        r'%s/<opportunity_type>' % feconf.CONTRIBUTOR_OPPORTUNITIES_DATA_URL,\n        contributor_dashboard.ContributionOpportunitiesHandler),\n    get_redirect_route(\n        r'/preferredtranslationlanguage',\n        contributor_dashboard.TranslationPreferenceHandler),\n    get_redirect_route(\n        r'%s' % feconf.REVIEWABLE_OPPORTUNITIES_URL,\n        contributor_dashboard.ReviewableOpportunitiesHandler),\n    get_redirect_route(\n        r'%s' % feconf.PINNED_OPPORTUNITIES_URL,\n        contributor_dashboard.LessonsPinningHandler,\n    ),\n    get_redirect_route(\n        r'/gettranslatabletexthandler',\n        contributor_dashboard.TranslatableTextHandler),\n    get_redirect_route(\n        r'%s' % feconf.MACHINE_TRANSLATION_DATA_URL,\n        contributor_dashboard.MachineTranslationStateTextsHandler),\n    get_redirect_route(\n        r'/usercontributionrightsdatahandler',\n        contributor_dashboard.UserContributionRightsDataHandler),\n    get_redirect_route(\n        r'/retrievefeaturedtranslationlanguages',\n        contributor_dashboard.FeaturedTranslationLanguagesHandler),\n    get_redirect_route(\n        r'/gettranslatabletopicnames',\n        contributor_dashboard.TranslatableTopicNamesHandler),\n    get_redirect_route(\n        r'/gettranslatabletopicnamesperclassroom',\n        contributor_dashboard.TranslatableTopicNamesPerClassroomHandler),\n    get_redirect_route(\n        r'%s' % feconf.NEW_SKILL_URL,\n        topics_and_skills_dashboard.NewSkillHandler),\n    get_redirect_route(\n        r'%s' % feconf.NEW_QUESTION_URL,\n        question_editor.QuestionCreationHandler),\n    get_redirect_route(\n        r'%s/<comma_separated_skill_ids>' % feconf.QUESTIONS_LIST_URL_PREFIX,\n        questions_list.QuestionsListHandler),\n    get_redirect_route(\n        r'%s/<comma_separated_skill_ids>' % feconf.QUESTION_COUNT_URL_PREFIX,\n        questions_list.QuestionCountDataHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>/<topic_url_fragment>' %\n        feconf.PRACTICE_SESSION_DATA_URL_PREFIX,\n        practice_sessions.PracticeSessionsPageDataHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>/<topic_url_fragment>'\n        r'/<story_url_fragment>' % feconf.REVIEW_TEST_DATA_URL_PREFIX,\n        review_tests.ReviewTestsPageDataHandler),\n    get_redirect_route(\n        r'%s/can_access_review_tests_page/<classroom_url_fragment>'\n        r'/<topic_url_fragment>/<story_url_fragment>'\n        % feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ReviewTestsPageAccessValidationHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>/<topic_url_fragment>'\n        r'/<story_url_fragment>' % feconf.STORY_DATA_HANDLER,\n        story_viewer.StoryPageDataHandler),\n    get_redirect_route(\n        r'%s/<story_url_fragment>' % feconf.STORY_URL_FRAGMENT_HANDLER,\n        story_editor.StoryUrlFragmentHandler),\n    get_redirect_route(\n        r'%s/<topic_name>' % feconf.TOPIC_NAME_HANDLER,\n        topic_editor.TopicNameHandler),\n    get_redirect_route(\n        r'%s/<topic_url_fragment>' % feconf.TOPIC_URL_FRAGMENT_HANDLER,\n        topic_editor.TopicUrlFragmentHandler),\n    get_redirect_route(\n        r'%s/<skill_description>' % feconf.SKILL_DESCRIPTION_HANDLER,\n        skill_editor.SkillDescriptionHandler),\n    get_redirect_route(\n        r'%s/<skill_id>' % feconf.DIAGNOSTIC_TEST_SKILL_ASSIGNMENT_HANDLER,\n        skill_editor.DiagnosticTestSkillAssignmentHandler),\n    get_redirect_route(\n        r'%s/' %\n        feconf.TOPIC_ID_TO_DIAGNOSTIC_TEST_SKILL_IDS_HANDLER,\n        topics_and_skills_dashboard.TopicIdToDiagnosticTestSkillIdsHandler),\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.DIAGNOSTIC_TEST_QUESTIONS_HANDLER_URL,\n        diagnostic_test_player.DiagnosticTestQuestionsHandler\n    ),\n    get_redirect_route(\n        r'%s' % feconf.CLASSROOM_DISPLAY_INFO_HANDLER_URL,\n        classroom.ClassroomDisplayInfoHandler),\n    get_redirect_route(\n        r'%s' % feconf.UPDATE_CLASSROOMS_ORDER_HANDLER_URL,\n        classroom.UpdateClassroomIndexMappingHandler),\n    get_redirect_route(\n        r'%s' % feconf.UNUSED_TOPICS_HANDLER_URL,\n        classroom.UnusedTopicsHandler),\n    get_redirect_route(\n        r'%s' % feconf.NEW_CLASSROOM_ID_HANDLER_URL,\n        classroom.NewClassroomIdHandler),\n    get_redirect_route(\n        r'%s' % feconf.NEW_CLASSROOM_HANDLER_URL,\n        classroom.NewClassroomHandler),\n    get_redirect_route(\n        r'%s' % feconf.TOPICS_TO_CLASSROOM_RELATION_HANDLER_URL,\n        classroom.TopicsToClassroomsRelationHandler),\n    get_redirect_route(\n        r'%s' % feconf.ALL_CLASSROOMS_SUMMARY_HANDLER_URL,\n        classroom.AllClassroomsSummaryHandler),\n    get_redirect_route(\n        r'%s/<classroom_id>' % feconf.CLASSROOM_HANDLER_URL,\n        classroom.ClassroomHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>' % feconf.CLASSROOM_URL_FRAGMENT_HANDLER,\n        classroom.ClassroomUrlFragmentHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>' % feconf.CLASSROOM_ID_HANDLER_URL,\n        classroom.ClassroomIdHandler\n    ),\n    get_redirect_route(\n        r'%s' % feconf.VOICEOVER_ADMIN_DATA_HANDLER_URL,\n        voiceover.VoiceoverAdminDataHandler\n    ),\n    get_redirect_route(\n        r'%s' % feconf.VOICEOVER_LANGUAGE_CODES_MAPPING_HANDLER_URL,\n        voiceover.VoiceoverLanguageCodesMappingHandler\n    ),\n    get_redirect_route(\n        r'%s' % feconf.VOICE_ARTIST_METADATA_HANDLER,\n        voiceover.VoiceArtistMetadataHandler\n    ),\n    get_redirect_route(\n        r'%s/<voice_artist_id>/<language_code>' %\n        feconf.GET_SAMPLE_VOICEOVERS_FOR_VOICE_ARTIST,\n        voiceover.GetSampleVoiceoversForGivenVoiceArtistHandler\n    ),\n    get_redirect_route(\n        r'/entity_voiceovers_bulk_handler/<entity_type>/<entity_id>/'\n        r'<entity_version>/<language_code>',\n        voiceover.EntityVoiceoversBulkHandler\n    ),\n\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>/<topic_url_fragment>'\n        r'/<story_url_fragment>/<node_id>' % feconf.STORY_PROGRESS_URL_PREFIX,\n        story_viewer.StoryProgressHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>/<topic_url_fragment>'\n        r'/<subtopic_url_fragment>' % feconf.SUBTOPIC_DATA_HANDLER,\n        subtopic_viewer.SubtopicPageDataHandler),\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.TOPIC_EDITOR_STORY_URL,\n        topic_editor.TopicEditorStoryHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>/<topic_url_fragment>'\n        % feconf.TOPIC_DATA_HANDLER,\n        topic_viewer.TopicPageDataHandler),\n    get_redirect_route(\n        r'%s/<classroom_url_fragment>' % feconf.CLASSROOM_DATA_HANDLER,\n        classroom.ClassroomDataHandler),\n    get_redirect_route(\n        r'%s' % feconf.NEW_TOPIC_URL,\n        topics_and_skills_dashboard.NewTopicHandler),\n    get_redirect_route(\n        r'%s' % feconf.UPLOAD_EXPLORATION_URL,\n        creator_dashboard.UploadExplorationHandler),\n    get_redirect_route(\n        '/learner_dashboard',\n        learner_dashboard.OldLearnerDashboardRedirectPage),\n    get_redirect_route(\n        r'%s' % feconf.LEARNER_DASHBOARD_TOPIC_AND_STORY_DATA_URL,\n        learner_dashboard.LearnerDashboardTopicsAndStoriesProgressHandler),\n    get_redirect_route(\n        r'%s' % feconf.LEARNER_COMPLETED_CHAPTERS_COUNT_DATA_URL,\n        learner_dashboard.LearnerCompletedChaptersCountHandler),\n    get_redirect_route(\n        r'%s' % feconf.LEARNER_DASHBOARD_COLLECTION_DATA_URL,\n        learner_dashboard.LearnerDashboardCollectionsProgressHandler),\n    get_redirect_route(\n        r'%s' % feconf.LEARNER_DASHBOARD_EXPLORATION_DATA_URL,\n        learner_dashboard.LearnerDashboardExplorationsProgressHandler),\n    get_redirect_route(\n        r'%s' % feconf.FEEDBACK_UPDATES_DATA_URL,\n        feedback_updates.FeedbackUpdatesHandler),\n    get_redirect_route(\n        r'%s' % feconf.LEARNER_DASHBOARD_IDS_DATA_URL,\n        learner_dashboard.LearnerDashboardIdsHandler),\n    get_redirect_route(\n        r'%s/<thread_id>' %\n        feconf.FEEDBACK_UPDATES_THREAD_DATA_URL,\n        feedback_updates.FeedbackThreadHandler),\n    get_redirect_route(\n        r'%s' % feconf.MERGE_SKILLS_URL,\n        topics_and_skills_dashboard.MergeSkillHandler),\n    get_redirect_route(\n        r'%s' % feconf.TOPICS_AND_SKILLS_DASHBOARD_DATA_URL,\n        topics_and_skills_dashboard.TopicsAndSkillsDashboardPageDataHandler),\n    get_redirect_route(\n        r'%s/<skill_id>' % feconf.UNASSIGN_SKILL_DATA_HANDLER_URL,\n        topics_and_skills_dashboard.TopicAssignmentsHandler),\n    get_redirect_route(\n        r'%s' % feconf.SKILL_DASHBOARD_DATA_URL,\n        topics_and_skills_dashboard.SkillsDashboardPageDataHandler),\n\n    get_redirect_route(\n        r'%s/<activity_type>/<activity_id>' %\n        feconf.LEARNER_INCOMPLETE_ACTIVITY_DATA_URL,\n        reader.LearnerIncompleteActivityHandler),\n\n    get_redirect_route(\n        r'%s/<activity_type>/<topic_id>' % feconf.LEARNER_GOALS_DATA_URL,\n        learner_goals.LearnerGoalsHandler),\n\n    get_redirect_route(\n        r'%s/<activity_type>/<activity_id>' % feconf.LEARNER_PLAYLIST_DATA_URL,\n        learner_playlist.LearnerPlaylistHandler),\n\n    get_redirect_route(\n        r'%s/<blog_post_url>' % feconf.BLOG_HOMEPAGE_DATA_URL,\n        blog_homepage.BlogPostDataHandler),\n    get_redirect_route(\n        r'%s/<author_username>' %\n        feconf.BLOG_AUTHOR_PROFILE_PAGE_DATA_URL_PREFIX,\n        blog_homepage.AuthorsPageHandler),\n    get_redirect_route(\n        r'%s' % feconf.BLOG_HOMEPAGE_DATA_URL,\n        blog_homepage.BlogHomepageDataHandler),\n    get_redirect_route(\n        r'%s' % feconf.BLOG_SEARCH_DATA_URL,\n        blog_homepage.BlogPostSearchHandler),\n\n    get_redirect_route(\n        r'/assetsdevhandler/<page_context>/<page_identifier>/'\n        'assets/<asset_type:(image|audio|thumbnail)>/<encoded_filename>',\n        resources.AssetDevHandler),\n    get_redirect_route(\n        r'/value_generator_handler/<generator_id>',\n        resources.ValueGeneratorHandler),\n    get_redirect_route(r'/promo_bar_handler', resources.PromoBarHandler),\n    get_redirect_route('/library', library.OldLibraryRedirectPage),\n    get_redirect_route(\n        r'%s' % feconf.LIBRARY_INDEX_DATA_URL, library.LibraryIndexHandler),\n    get_redirect_route(\n        r'%s' % feconf.LIBRARY_GROUP_DATA_URL,\n        library.LibraryGroupIndexHandler),\n    get_redirect_route(\n        r'%s' % feconf.LIBRARY_SEARCH_DATA_URL, library.SearchHandler),\n    get_redirect_route(r'/gallery', library.LibraryRedirectPage),\n    get_redirect_route(r'/contribute', library.LibraryRedirectPage),\n    get_redirect_route(r'/playtest', library.LibraryRedirectPage),\n    get_redirect_route(\n        feconf.EXPLORATION_SUMMARIES_DATA_URL,\n        library.ExplorationSummariesHandler),\n    get_redirect_route(\n        feconf.COLLECTION_SUMMARIES_DATA_URL,\n        library.CollectionSummariesHandler),\n\n    get_redirect_route(\n        r'/profilehandler/data/<username>', profile.ProfileHandler),\n    get_redirect_route(\n        r'/mailinglistsubscriptionhandler',\n        profile.MailingListSubscriptionHandler),\n    get_redirect_route(\n        r'%s/<secret>' % feconf.BULK_EMAIL_WEBHOOK_ENDPOINT,\n        profile.BulkEmailWebhookEndpoint),\n    get_redirect_route(\n        feconf.PREFERENCES_DATA_URL, profile.PreferencesHandler),\n    get_redirect_route(r'%s' % feconf.SIGNUP_URL, profile.SignupPage),\n    get_redirect_route(r'%s' % feconf.SIGNUP_DATA_URL, profile.SignupHandler),\n    get_redirect_route(\n        feconf.DELETE_ACCOUNT_HANDLER_URL, profile.DeleteAccountHandler),\n    get_redirect_route(\n        feconf.EXPORT_ACCOUNT_HANDLER_URL, profile.ExportAccountHandler),\n    get_redirect_route(\n        r'%s' % feconf.USERNAME_CHECK_DATA_URL, profile.UsernameCheckHandler),\n    get_redirect_route(\n        r'%s' % feconf.SITE_LANGUAGE_DATA_URL, profile.SiteLanguageHandler),\n    get_redirect_route(r'/userinfohandler', profile.UserInfoHandler),\n    get_redirect_route(r'/userinfohandler/data', profile.UserInfoHandler),\n    get_redirect_route(r'/url_handler', profile.UrlHandler),\n    get_redirect_route(\n        r'/moderatorhandler/featured', moderator.FeaturedActivitiesHandler),\n    get_redirect_route(\n        r'/moderatorhandler/email_draft', moderator.EmailDraftHandler),\n\n    get_redirect_route(\n        r'/memorycachehandler', release_coordinator.MemoryCacheHandler),\n    get_redirect_route(\n        r'%s' % feconf.FEATURE_FLAGS_URL,\n        release_coordinator.FeatureFlagsHandler),\n    get_redirect_route(\n        r'%s' % feconf.USER_GROUPS_HANDLER_URL,\n        release_coordinator.UserGroupHandler),\n    get_redirect_route(\n        r'%s/can_access_exploration_player_page/<exploration_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.ExplorationPlayerAccessValidationPage\n    ),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_INIT_URL_PREFIX,\n        reader.ExplorationHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_PRETESTS_URL_PREFIX,\n        reader.PretestHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_FEATURES_PREFIX,\n        features.ExplorationFeaturesHandler),\n    get_redirect_route(\n        '/explorehandler/exploration_start_event/<exploration_id>',\n        reader.ExplorationStartEventHandler),\n    get_redirect_route(\n        '/explorehandler/exploration_actual_start_event/<exploration_id>',\n        reader.ExplorationActualStartEventHandler),\n    get_redirect_route(\n        '/explorehandler/solution_hit_event/<exploration_id>',\n        reader.SolutionHitEventHandler),\n    get_redirect_route(\n        '/sync_logged_out_and_logged_in_progress/<exploration_id>',\n        reader.SyncLoggedOutLearnerProgressHandler),\n    get_redirect_route(\n        r'/explorehandler/state_hit_event/<exploration_id>',\n        reader.StateHitEventHandler),\n    get_redirect_route(\n        r'/explorehandler/state_complete_event/<exploration_id>',\n        reader.StateCompleteEventHandler),\n    get_redirect_route(\n        r'/explorehandler/checkpoint_reached_by_logged_out_user/<exploration_id>', # pylint: disable=line-too-long\n        reader.SaveTransientCheckpointProgressHandler),\n    get_redirect_route(\n        '/progress/<unique_progress_url_id>',\n        reader.TransientCheckpointUrlPage),\n    get_redirect_route(\n        r'/explorehandler/leave_for_refresher_exp_event/<exploration_id>',\n        reader.LeaveForRefresherExpEventHandler),\n    get_redirect_route(\n        r'/explorehandler/answer_submitted_event/<exploration_id>',\n        reader.AnswerSubmittedEventHandler),\n    get_redirect_route(\n        r'/explorehandler/checkpoint_reached/<exploration_id>',\n        reader.CheckpointReachedEventHandler),\n    get_redirect_route(\n        r'/explorehandler/restart/<exploration_id>',\n        reader.ExplorationRestartEventHandler),\n    get_redirect_route(\n        r'/explorehandler/give_feedback/<exploration_id>',\n        reader.ReaderFeedbackHandler),\n    get_redirect_route(\n        r'/explorehandler/exploration_complete_event/<exploration_id>',\n        reader.ExplorationCompleteEventHandler),\n    get_redirect_route(\n        r'/explorehandler/exploration_maybe_leave_event/<exploration_id>',\n        reader.ExplorationMaybeLeaveHandler),\n    get_redirect_route(\n        r'/explorehandler/stats_events/<exploration_id>',\n        reader.StatsEventsHandler),\n    get_redirect_route(\n        r'/explorehandler/store_playthrough/<exploration_id>',\n        reader.StorePlaythroughHandler),\n    get_redirect_route(\n        r'/explorehandler/rating/<exploration_id>', reader.RatingHandler),\n    get_redirect_route(\n        r'/explorehandler/recommendations/<exploration_id>',\n        reader.RecommendationsHandler),\n    get_redirect_route(\n        r'%s/<entity_type>/<entity_id>' % (\n            feconf.LEARNER_ANSWER_DETAILS_SUBMIT_URL),\n        reader.LearnerAnswerDetailsSubmissionHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>/<state_name>/<version>' % (\n            feconf.STATE_VERSION_HISTORY_URL_PREFIX\n        ), reader.StateVersionHistoryHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>/<version>' % (\n            feconf.METADATA_VERSION_HISTORY_URL_PREFIX\n        ), reader.MetadataVersionHistoryHandler),\n\n    get_redirect_route(\n        r'%s/<question_id>' % feconf.QUESTION_EDITOR_DATA_URL_PREFIX,\n        question_editor.EditableQuestionDataHandler),\n\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_DATA_PREFIX,\n        editor.ExplorationHandler),\n    get_redirect_route(\n        r'/editsallowedhandler/<exploration_id>',\n        editor.ExplorationEditsAllowedHandler),\n    get_redirect_route(\n        r'/createhandler/download/<exploration_id>',\n        editor.ExplorationFileDownloader),\n    get_redirect_route(\n        r'%s/<entity_type>/<entity_id>' % (\n            feconf.EXPLORATION_IMAGE_UPLOAD_PREFIX),\n        editor.ImageUploadHandler),\n    get_redirect_route(\n        r'/createhandler/audioupload/<exploration_id>',\n        voice_artist.AudioUploadHandler),\n    get_redirect_route(\n        r'/createhandler/state_yaml/<exploration_id>',\n        editor.StateYamlHandler),\n    get_redirect_route(\n        r'/createhandler/check_revert_valid/<exploration_id>/<version>',\n        editor.ExplorationCheckRevertValidHandler),\n    get_redirect_route(\n        r'/createhandler/revert/<exploration_id>',\n        editor.ExplorationRevertHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_RIGHTS_PREFIX,\n        editor.ExplorationRightsHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.USER_PERMISSIONS_URL_PREFIX,\n        editor.UserExplorationPermissionsHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_STATUS_PREFIX,\n        editor.ExplorationStatusHandler),\n    get_redirect_route(\n        r'/createhandler/moderatorrights/<exploration_id>',\n        editor.ExplorationModeratorRightsHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.USER_EXPLORATION_EMAILS_PREFIX,\n        editor.UserExplorationEmailsHandler),\n    get_redirect_route(\n        r'/createhandler/snapshots/<exploration_id>',\n        editor.ExplorationSnapshotsHandler),\n    get_redirect_route(\n        r'/createhandler/statistics/<exploration_id>',\n        editor.ExplorationStatisticsHandler),\n    get_redirect_route(\n        r'/createhandler/state_interaction_stats/<exploration_id>/<state_name>',\n        editor.StateInteractionStatsHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_STATE_ANSWER_STATS_PREFIX,\n        editor.StateAnswerStatisticsHandler),\n    get_redirect_route(\n        r'/createhandler/started_tutorial_event/<exploration_id>',\n        editor.StartedTutorialEventHandler),\n    get_redirect_route(\n        r'/createhandler/started_translation_tutorial_event/<exploration_id>',\n        voice_artist.StartedTranslationTutorialEventHandler),\n    get_redirect_route(\n        r'/createhandler/autosave_draft/<exploration_id>',\n        editor.EditorAutosaveHandler),\n    get_redirect_route(\n        r'/createhandler/get_top_unresolved_answers/<exploration_id>',\n        editor.TopUnresolvedAnswersHandler),\n    get_redirect_route(\n        r'%s/<entity_type>/<entity_id>' %\n        feconf.LEARNER_ANSWER_INFO_HANDLER_URL,\n        editor.LearnerAnswerInfoHandler),\n    get_redirect_route(\n        r'/entity_translations_bulk_handler/<entity_type>/<entity_id>/<entity_version>', # pylint: disable=line-too-long\n        editor.EntityTranslationsBulkHandler),\n\n    get_redirect_route(\n        r'%s' % feconf.RECENT_COMMITS_DATA_URL,\n        recent_commits.RecentCommitsHandler),\n    get_redirect_route(\n        r'%s' % feconf.RECENT_FEEDBACK_MESSAGES_DATA_URL,\n        feedback.RecentFeedbackMessagesHandler),\n\n    get_redirect_route(\n        r'%s/<thread_id>' % feconf.FEEDBACK_THREAD_VIEW_EVENT_URL,\n        feedback.FeedbackThreadViewEventHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.FEEDBACK_THREADLIST_URL_PREFIX,\n        feedback.ThreadListHandler),\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.FEEDBACK_THREADLIST_URL_PREFIX_FOR_TOPICS,\n        feedback.ThreadListHandlerForTopicsHandler),\n    get_redirect_route(\n        r'%s/<thread_id>' % feconf.FEEDBACK_THREAD_URL_PREFIX,\n        feedback.ThreadHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.FEEDBACK_STATS_URL_PREFIX,\n        feedback.FeedbackStatsHandler),\n    get_redirect_route(\n        r'%s/' % feconf.SUGGESTION_URL_PREFIX,\n        suggestion.SuggestionHandler),\n    get_redirect_route(\n        r'%s/<suggestion_id>' % feconf.UPDATE_TRANSLATION_SUGGESTION_URL_PREFIX,\n        suggestion.UpdateTranslationSuggestionHandler),\n    get_redirect_route(\n        r'%s/<suggestion_id>' % feconf.UPDATE_QUESTION_SUGGESTION_URL_PREFIX,\n        suggestion.UpdateQuestionSuggestionHandler),\n    get_redirect_route(\n        r'%s' % feconf.QUESTIONS_URL_PREFIX,\n        reader.QuestionPlayerHandler),\n    get_redirect_route(\n        r'%s/exploration/<target_id>/<suggestion_id>' %\n        feconf.SUGGESTION_ACTION_URL_PREFIX,\n        suggestion.SuggestionToExplorationActionHandler),\n    get_redirect_route(\n        r'%s/resubmit/<suggestion_id>' % feconf.SUGGESTION_ACTION_URL_PREFIX,\n        suggestion.ResubmitSuggestionHandler),\n    get_redirect_route(\n        r'%s/skill/<target_id>/<suggestion_id>' %\n        feconf.SUGGESTION_ACTION_URL_PREFIX,\n        suggestion.SuggestionToSkillActionHandler),\n    get_redirect_route(\n        r'%s' % feconf.SUGGESTION_LIST_URL_PREFIX,\n        suggestion.SuggestionListHandler),\n    get_redirect_route(\n        r'/getreviewablesuggestions/<target_type>/<suggestion_type>',\n        suggestion.ReviewableSuggestionsHandler),\n    get_redirect_route(\n        r'/getsubmittedsuggestions/<target_type>/<suggestion_type>',\n        suggestion.UserSubmittedSuggestionsHandler),\n    get_redirect_route(\n        r'%s' % feconf.SUBSCRIBE_URL_PREFIX,\n        subscriptions.SubscribeHandler),\n    get_redirect_route(\n        r'%s' % feconf.UNSUBSCRIBE_URL_PREFIX,\n        subscriptions.UnsubscribeHandler),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.FLAG_EXPLORATION_URL_PREFIX,\n        reader.FlagExplorationHandler),\n    get_redirect_route(\n        r'%s/<collection_id>' % feconf.COLLECTION_DATA_URL_PREFIX,\n        collection_viewer.CollectionDataHandler),\n    get_redirect_route(\n        r'%s/<collection_id>' % feconf.COLLECTION_EDITOR_DATA_URL_PREFIX,\n        collection_editor.EditableCollectionDataHandler),\n    get_redirect_route(\n        r'%s/<collection_id>' % feconf.COLLECTION_RIGHTS_PREFIX,\n        collection_editor.CollectionRightsHandler),\n    get_redirect_route(\n        r'%s/<collection_id>' % feconf.COLLECTION_PUBLISH_PREFIX,\n        collection_editor.CollectionPublishHandler),\n    get_redirect_route(\n        r'%s/<collection_id>' % feconf.COLLECTION_UNPUBLISH_PREFIX,\n        collection_editor.CollectionUnpublishHandler),\n\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.TOPIC_EDITOR_DATA_URL_PREFIX,\n        topic_editor.EditableTopicDataHandler),\n    get_redirect_route(\n        r'%s/<topic_id>/<subtopic_id>' %\n        feconf.SUBTOPIC_PAGE_EDITOR_DATA_URL_PREFIX,\n        topic_editor.EditableSubtopicPageDataHandler),\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.TOPIC_RIGHTS_URL_PREFIX,\n        topic_editor.TopicRightsHandler),\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.TOPIC_STATUS_URL_PREFIX,\n        topic_editor.TopicPublishHandler),\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.TOPIC_SEND_MAIL_URL_PREFIX,\n        topic_editor.TopicPublishSendMailHandler),\n    get_redirect_route(\n        r'%s/' % feconf.TOPIC_ID_TO_TOPIC_NAME,\n        topic_editor.TopicIdToTopicNameHandler),\n\n    get_redirect_route(\n        r'%s/<selected_skill_ids>' % feconf.CONCEPT_CARD_DATA_URL_PREFIX,\n        concept_card_viewer.ConceptCardDataHandler),\n    get_redirect_route(\n        r'%s/<question_id>' % feconf.QUESTION_SKILL_LINK_URL_PREFIX,\n        question_editor.QuestionSkillLinkHandler),\n    get_redirect_route(\n        r'%s/<comma_separated_skill_ids>' % feconf.SKILL_DATA_URL_PREFIX,\n        skill_editor.SkillDataHandler),\n    get_redirect_route(\n        r'%s' % feconf.FETCH_SKILLS_URL_PREFIX,\n        skill_editor.FetchSkillsHandler),\n    get_redirect_route(\n        r'%s/can_access_skill_editor/<skill_id>' %\n        feconf.ACCESS_VALIDATION_HANDLER_PREFIX,\n        access_validators.SkillEditorPageAccessValidationHandler),\n    get_redirect_route(\n        r'%s/<skill_id>' % feconf.SKILL_EDITOR_DATA_URL_PREFIX,\n        skill_editor.EditableSkillDataHandler),\n    get_redirect_route(\n        r'%s' % feconf.SKILL_MASTERY_DATA_URL,\n        skill_mastery.SkillMasteryDataHandler),\n    get_redirect_route(\n        r'%s/<skill_id>' % feconf.SKILL_RIGHTS_URL_PREFIX,\n        skill_editor.SkillRightsHandler),\n\n    get_redirect_route(\n        r'%s' % feconf.SUBTOPIC_MASTERY_DATA_URL,\n        skill_mastery.SubtopicMasteryDataHandler),\n\n    get_redirect_route(\n        r'%s/<story_id>' % feconf.STORY_EDITOR_DATA_URL_PREFIX,\n        story_editor.EditableStoryDataHandler),\n    get_redirect_route(\n        r'%s/<story_id>' % feconf.STORY_PUBLISH_HANDLER,\n        story_editor.StoryPublishHandler),\n    get_redirect_route(\n        r'%s/<story_id>' %\n        feconf.VALIDATE_STORY_EXPLORATIONS_URL_PREFIX,\n        story_editor.ValidateExplorationsHandler),\n\n    get_redirect_route(\n        r'/emaildashboarddatahandler',\n        email_dashboard.EmailDashboardDataHandler),\n    get_redirect_route(\n        r'/querystatuscheck', email_dashboard.QueryStatusCheckHandler),\n    get_redirect_route(\n        r'/emaildashboardcancelresult/<query_id>',\n        email_dashboard.EmailDashboardCancelEmailHandler),\n    get_redirect_route(\n        r'/emaildashboardtestbulkemailhandler/<query_id>',\n        email_dashboard.EmailDashboardTestBulkEmailHandler),\n    get_redirect_route(\n        r'%s' % feconf.EXPLORATION_METADATA_SEARCH_URL,\n        collection_editor.ExplorationMetadataSearchHandler),\n    get_redirect_route(\n        r'/explorationdataextractionhandler', admin.DataExtractionQueryHandler),\n    get_redirect_route(\n        r'/senddummymailtoadminhandler', admin.SendDummyMailToAdminHandler),\n    get_redirect_route(r'/updateusernamehandler', admin.UpdateUsernameHandler),\n    get_redirect_route(\n        r'/numberofdeletionrequestshandler',\n        admin.NumberOfDeletionRequestsHandler),\n    get_redirect_route(\n        r'/verifyusermodelsdeletedhandler',\n        admin.VerifyUserModelsDeletedHandler),\n    get_redirect_route(r'/deleteuserhandler', admin.DeleteUserHandler),\n    get_redirect_route(\n        r'/interactions',\n        admin.InteractionsByExplorationIdHandler),\n    get_redirect_route(r'/frontend_errors', FrontendErrorHandler),\n\n    get_redirect_route(r'/session_begin', base.SessionBeginHandler),\n    get_redirect_route(r'/session_end', base.SessionEndHandler),\n\n    get_redirect_route(\n        r'%s/%s/<exploration_id>' % (\n            feconf.IMPROVEMENTS_URL_PREFIX,\n            constants.TASK_ENTITY_TYPE_EXPLORATION),\n        improvements.ExplorationImprovementsHandler),\n    get_redirect_route(\n        r'%s/%s/<exploration_id>' % (\n            feconf.IMPROVEMENTS_HISTORY_URL_PREFIX,\n            constants.TASK_ENTITY_TYPE_EXPLORATION),\n        improvements.ExplorationImprovementsHistoryHandler),\n    get_redirect_route(\n        r'%s/%s/<exploration_id>' % (\n            feconf.IMPROVEMENTS_CONFIG_URL_PREFIX,\n            constants.TASK_ENTITY_TYPE_EXPLORATION),\n        improvements.ExplorationImprovementsConfigHandler),\n\n    get_redirect_route(\n        r'%s' % feconf.BLOG_ADMIN_ROLE_HANDLER_URL,\n        blog_admin.BlogAdminRolesHandler),\n    get_redirect_route(\n        r'/blogadminhandler', blog_admin.BlogAdminHandler),\n\n    get_redirect_route('/beam_job', beam_jobs.BeamJobHandler),\n    get_redirect_route('/beam_job_run', beam_jobs.BeamJobRunHandler),\n    get_redirect_route(\n        '/beam_job_run_result', beam_jobs.BeamJobRunResultHandler),\n\n    get_redirect_route(\n        r'%s/<blog_post_id>' % feconf.BLOG_EDITOR_DATA_URL_PREFIX,\n        blog_dashboard.BlogPostHandler),\n    get_redirect_route(\n        r'%s/<blog_post_id>' % feconf.BLOG_TITLE_HANDLER,\n        blog_dashboard.BlogPostTitleHandler),\n    get_redirect_route(\n        r'%s' % feconf.BLOG_DASHBOARD_DATA_URL,\n        blog_dashboard.BlogDashboardDataHandler),\n\n    get_redirect_route(\n        r'/issuesdatahandler/<exploration_id>', editor.FetchIssuesHandler),\n\n    get_redirect_route(\n        r'/playthroughdatahandler/<exploration_id>/<playthrough_id>',\n        editor.FetchPlaythroughHandler),\n\n    get_redirect_route(\n        r'/resolveissuehandler/<exploration_id>', editor.ResolveIssueHandler),\n\n    get_redirect_route(\n        r'%s' % feconf.CSRF_HANDLER_URL, base.CsrfTokenHandler),\n\n    get_redirect_route(\n        r'/feature_flags_evaluation_handler',\n        feature_flag.FeatureFlagsEvaluationHandler),\n    get_redirect_route(\n        r'/feature_flag_dummy_handler',\n        feature_flag.FeatureFlagDummyHandler),\n\n    get_redirect_route(\n        r'%s' % (\n            android_validation_constants.INCOMING_ANDROID_FEEDBACK_REPORT_URL),\n        incoming_app_feedback_report.IncomingAndroidFeedbackReportHandler),\n\n    get_redirect_route(\n        r'/voice_artist_management_handler/<entity_type>/<entity_id>',\n        voice_artist.VoiceArtistManagementHandler),\n\n    get_redirect_route(\n        r'/topics_and_skills_dashboard/categorized_and_untriaged_skills_data',\n        topics_and_skills_dashboard\n            .CategorizedAndUntriagedSkillsDataHandler),\n\n    get_redirect_route(\n        r'/entity_translations_handler/<entity_type>/<entity_id>/'\n        r'<entity_version>/<language_code>',\n        reader.EntityTranslationHandler),\n    get_redirect_route(\n        r'/create_learner_group_handler',\n        learner_group.CreateLearnerGroupHandler),\n    get_redirect_route(\n        r'/update_learner_group_handler/<learner_group_id>',\n        learner_group.LearnerGroupHandler),\n    get_redirect_route(\n        r'/delete_learner_group_handler/<learner_group_id>',\n        learner_group.LearnerGroupHandler),\n    get_redirect_route(\n        r'%s' % feconf.FACILITATOR_DASHBOARD_HANDLER,\n        learner_group.FacilitatorDashboardHandler),\n    get_redirect_route(\n        r'%s' % feconf.LEARNER_DASHBOARD_LEARNER_GROUPS_HANDLER,\n        learner_group.LearnerDashboardLearnerGroupsHandler),\n    get_redirect_route(\n        r'/view_learner_group_info_handler/<learner_group_id>',\n        learner_group.ViewLearnerGroupInfoHandler),\n    get_redirect_route(\n        r'/learner_group_search_syllabus_handler',\n        learner_group.LearnerGroupSearchSyllabusHandler),\n    get_redirect_route(\n        r'/learner_group_syllabus_handler/<learner_group_id>',\n        learner_group.LearnerGroupSyllabusHandler),\n    get_redirect_route(\n        r'/learner_group_user_progress_handler/<learner_group_id>',\n        learner_group.LearnerGroupLearnerProgressHandler),\n    get_redirect_route(\n        r'/learner_group_learner_specific_progress_handler/<learner_group_id>',\n        learner_group.LearnerGroupLearnerSpecificProgressHandler\n    ),\n    get_redirect_route(\n        r'/learner_group_search_learner_handler',\n        learner_group.LearnerGroupSearchLearnerHandler),\n    get_redirect_route(\n        r'/learner_group_learners_info_handler/<learner_group_id>',\n        learner_group.LearnerGroupLearnersInfoHandler),\n    get_redirect_route(\n        r'/learner_group_learner_invitation_handler/<learner_group_id>',\n        learner_group.LearnerGroupLearnerInvitationHandler),\n    get_redirect_route(\n        r'/learner_group_progress_sharing_permission_handler/<learner_group_id>', # pylint: disable=line-too-long\n        learner_group.LearnerGroupProgressSharingPermissionHandler),\n    get_redirect_route(\n        r'/exit_learner_group_handler/<learner_group_id>',\n        learner_group.ExitLearnerGroupHandler),\n    get_redirect_route(\n        r'/user_progress_in_stories_chapters_handler/<username>',\n        learner_group.LearnerStoriesChaptersProgressHandler),\n    get_redirect_route(\n        '/learner_groups_feature_status_handler',\n        learner_group.LearnerGroupsFeatureStatusHandler),\n    get_redirect_route('/android_data', android.AndroidActivityHandler)\n]\n\n# Adding redirects for topic landing pages.\nfor subject, topics in constants.AVAILABLE_LANDING_PAGES.items():\n    for topic in topics:\n        URLS.append(\n            get_redirect_route(\n                r'/%s/%s' % (subject, topic),\n                oppia_root.OppiaRootPage))\n\nif constants.DEV_MODE:\n    URLS.append(\n        get_redirect_route(\n            r'/initialize_android_test_data',\n            android.InitializeAndroidTestDataHandler))\n\n# Adding redirects for all stewards landing pages.\nfor stewards_route in constants.STEWARDS_LANDING_PAGE['ROUTES']:\n    URLS.append(\n        get_redirect_route(\n            r'/%s' % stewards_route, oppia_root.OppiaRootPage))\n\n# Redirect all routes handled using angular router to the oppia root page.\nfor page in constants.PAGES_REGISTERED_WITH_FRONTEND.values():\n    if not 'MANUALLY_REGISTERED_WITH_BACKEND' in page:\n        if 'LIGHTWEIGHT' in page:\n            URLS.append(\n                get_redirect_route(\n                    r'/%s' % page['ROUTE'],\n                    oppia_root.OppiaLightweightRootPage\n                )\n            )\n        else:\n            URLS.append(\n                get_redirect_route(\n                    r'/%s' % page['ROUTE'], oppia_root.OppiaRootPage))\n\n# Manually redirect routes with url fragments to the oppia root page.\nURLS.extend((\n    get_redirect_route(r'/profile/<username>', oppia_root.OppiaRootPage),\n    get_redirect_route(\n        r'/collection/<collection_id>', oppia_root.OppiaRootPage),\n    get_redirect_route(\n        r'%s/story/<story_url_fragment>' % feconf.TOPIC_VIEWER_URL_PREFIX,\n        oppia_root.OppiaRootPage),\n    get_redirect_route(\n        r'/learn/<classroom_url_fragment>',\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EXPLORATION_URL_EMBED_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s%s' % (\n            feconf.TOPIC_VIEWER_URL_PREFIX,\n            feconf.PRACTICE_SESSION_URL_PREFIX,\n        ),\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/story' % feconf.TOPIC_VIEWER_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/revision' % feconf.TOPIC_VIEWER_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/practice' % feconf.TOPIC_VIEWER_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s' % feconf.TOPIC_VIEWER_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/<blog_post_url>' % feconf.BLOG_HOMEPAGE_URL,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/<topic_id>' % feconf.TOPIC_EDITOR_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/<author_username>' % feconf.BLOG_AUTHOR_PROFILE_PAGE_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/<exploration_id>' % feconf.EDITOR_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n      get_redirect_route(\n        r'%s/<skill_id>' % feconf.SKILL_EDITOR_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n    get_redirect_route(\n        r'%s/<story_id>' % feconf.STORY_EDITOR_URL_PREFIX,\n        oppia_root.OppiaRootPage\n    ),\n))\n\n# Add cron urls. Note that cron URLs MUST start with /cron for them to work\n# in production (see dispatch() in base.py).\nURLS.extend((\n    get_redirect_route(\n        r'/cron/models/cleanup', cron.CronModelsCleanupHandler),\n    get_redirect_route(\n        r'/cron/users/user_deletion', cron.CronUserDeletionHandler),\n    get_redirect_route(\n        r'/cron/users/fully_complete_user_deletion',\n        cron.CronFullyCompleteUserDeletionHandler),\n    get_redirect_route(\n        r'/cron/mail/admins/contributor_dashboard_bottlenecks',\n        cron.CronMailAdminContributorDashboardBottlenecksHandler),\n    get_redirect_route(\n        r'/cron/mail/reviewers/contributor_dashboard_suggestions',\n        cron.CronMailReviewersContributorDashboardSuggestionsHandler),\n    get_redirect_route(\n        r'/cron/app_feedback_report/scrub_expiring_reports',\n        cron.CronAppFeedbackReportsScrubberHandlerPage),\n    get_redirect_route(\n        r'/cron/explorations/recommendations',\n        cron.CronExplorationRecommendationsHandler),\n    get_redirect_route(\n        r'/cron/explorations/search_rank', cron.CronActivitySearchRankHandler),\n    get_redirect_route(\n        r'/cron/blog_posts/search_rank', cron.CronBlogPostSearchRankHandler),\n    get_redirect_route(\n        r'/cron/users/dashboard_stats', cron.CronDashboardStatsHandler),\n    get_redirect_route(\n        r'/cron/mail/curriculum_admins/chapter_publication_notfications',\n        cron.CronMailChapterPublicationsNotificationsHandler),\n    get_redirect_route(\n        r'/cron/mail/reviewers/new_contributor_dashboard_suggestions',\n        cron.CronMailReviewerNewSuggestionsHandler),\n))\n\n# Add tasks urls.\nURLS.extend((\n    get_redirect_route(\n        r'%s' % feconf.TASK_URL_FEEDBACK_MESSAGE_EMAILS,\n        tasks.UnsentFeedbackEmailHandler),\n    get_redirect_route(\n        r'%s' % (\n            feconf\n            .TASK_URL_CONTRIBUTOR_DASHBOARD_ACHIEVEMENT_NOTIFICATION_EMAILS),\n        tasks.ContributorDashboardAchievementEmailHandler),\n    get_redirect_route(\n        r'%s' % feconf.TASK_URL_FLAG_EXPLORATION_EMAILS,\n        tasks.FlagExplorationEmailHandler),\n    get_redirect_route(\n        r'%s' % feconf.TASK_URL_INSTANT_FEEDBACK_EMAILS,\n        tasks.InstantFeedbackMessageEmailHandler),\n    get_redirect_route(\n        r'%s' % feconf.TASK_URL_FEEDBACK_STATUS_EMAILS,\n        tasks.FeedbackThreadStatusChangeEmailHandler),\n    get_redirect_route(\n        r'%s' % feconf.TASK_URL_DEFERRED, tasks.DeferredTasksHandler),\n))\n\n# Add URLs to static resources that differ between deployments.\nURLS.extend((\n    get_redirect_route('/favicon.ico', resources.FaviconHandler),\n    get_redirect_route('/robots.txt', resources.RobotsTxtHandler),\n    get_redirect_route(\n        '/assets/copyrighted-images/<folder>/<filename>',\n        resources.CopyrightImagesHandler\n    ),\n))\n\n# 404 error handler (Needs to be at the end of the URLS list).\nURLS.append(get_redirect_route(r'/<:.*>', base.Error404Handler))\n\n\nclass NdbWsgiMiddleware:\n    \"\"\"Wraps the WSGI application into the NDB client context.\"\"\"\n\n    def __init__(self, wsgi_app: webapp2.WSGIApplication) -> None:\n        self.wsgi_app = wsgi_app\n\n    def __call__(\n        self,\n        environ: Dict[str, str],\n        start_response: webapp2.Response\n    ) -> webapp2.Response:\n        global_cache = datastore_services.RedisCache(\n            cache_services.CLOUD_NDB_REDIS_CLIENT)\n        with datastore_services.get_ndb_context(global_cache=global_cache):\n            return self.wsgi_app(environ, start_response)\n\n\napp_without_context = webapp2.WSGIApplication(URLS, debug=feconf.DEBUG)\napp = NdbWsgiMiddleware(app_without_context)\nfirebase_auth_services.establish_firebase_connection()\n"
    }
  ],
  "questions": [
    "Hey @HardikGoyal2003 \n\nHi, I can help explain my planned approach for fixing this 404 error issue:\n\nKey files to modify:\n1. `collection-player-auth.guard.ts`: Update error handling in the route guard to properly handle collection validation failures\n2. `collection-player.component.ts`: Add error state handling for invalid/missing collections\n\nPlanned changes:\n- Add proper error catching in the auth guard's `canActivate()` method\n- Implement graceful fallback when collection validation fails\n- Add unit tests to verify error handling in `collection-player-auth.guard.spec.ts`\n\nI'll first reproduce the issue locally by:\n1. Setting up collection editor access\n2. Creating test explorations and collections\n3. Verifying the 404 error occurs on collection player page\n\nWould this approach work? I can elaborate on any part of the implementation plan.\n\nLet me know if you'd like me to proceed with these changes would love to take this issue on!\n\nThanks!",
    "@shwetd19 Can you first show if this issue is reproducible? If it is reproducible, please mention the lines of code you will be changing, and a video demo that, it fixes the issue. Thanks!"
  ],
  "golden_answers": [
    "This is due to the improper migration of the collection page,\n\nTo fix this issue, the route also needs to be registered as a backend route in [main.py](https://github.com/oppia/oppia/blob/develop/main.py#L1231)",
    "This is due to the improper migration of the collection page,\n\nTo fix this issue, the route also needs to be registered as a backend route in [main.py](https://github.com/oppia/oppia/blob/develop/main.py#L1231)"
  ],
  "questions_generated": [
    "What is the role of the 'MockAccessValidationBackendApiService' class in debugging the 404 error on the collection player page?",
    "How can a developer identify which Pull Request (PR) caused the 404 Not Found error on the collection player page?",
    "What steps are recommended for a developer to take before addressing the 404 Not Found error in the collection player page?",
    "What are some of the controllers included in the 'main.py' file, and how do they relate to the collection player page?",
    "What is the expected behavior when accessing a valid collection player page, and how does it differ from the current behavior described in the issue?",
    "Why is it important for new contributors to follow the guidelines for choosing and setting up issues in the Oppia repository?"
  ],
  "golden_answers_generated": [
    "The 'MockAccessValidationBackendApiService' class in the collection-player-auth.guard.spec.ts file is used to simulate various conditions for testing, including a 404 error. It contains a method 'validateAccessToCollectionPlayerPage' that can be configured to reject with a 404 error if certain conditions, like an invalid 'collectionId', are met. This allows developers to test how the application handles such errors without needing to create the error conditions in the live environment.",
    "Developers are advised to follow the steps outlined in the Oppia wiki to identify the PR that introduced the bug. This involves checking the commit history to pinpoint changes around the time the bug was first noticed. If a specific PR is identified, developers should comment on the issue with a link to it. If not, mentioning the commit hash of the oldest commit where the bug is observed, along with the date, is recommended.",
    "Before addressing the bug, developers should first identify the PR that may have introduced the issue. If identified, they should comment on the issue with the PR link. If not, they should note the commit hash of the oldest occurrence of the bug. Developers are then encouraged to detail their approach to fixing the issue, including the files they plan to modify and what changes they intend to make.",
    "The 'main.py' file includes various controllers such as 'collection_viewer', 'collection_editor', 'base', and others. The 'collection_viewer' controller is directly related to the collection player page as it likely handles requests and responses for viewing collections. Understanding the interactions between these controllers can help in debugging and resolving issues related to collection viewing.",
    "The expected behavior when accessing a valid collection player page is that the page should load without any errors, displaying the collection content properly. However, the current behavior described in the issue is that accessing a valid collection player page results in a 404 Not Found error, indicating the page could not be located or accessed, which is contrary to the expected functionality.",
    "Following the guidelines for choosing and setting up issues ensures that new contributors comply with the project's standards, making their contributions more effective and easier to review. It helps maintain consistency, ensures that contributors understand the requirements for setting up their development environment, and aligns their work with the project’s overarching goals. This is especially important for first-time contributors to ensure a smooth onboarding process."
  ]
}