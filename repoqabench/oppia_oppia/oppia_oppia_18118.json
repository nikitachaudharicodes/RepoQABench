{
  "repo_name": "oppia_oppia",
  "issue_id": "18118",
  "issue_description": "# [BUG]: A horizontal line is seen on the page while tabbing through the Fractions page \n\n### Describe the bug\n\nA horizontal line is seen on the page while tabbing through the Fractions page \n\n### Steps To Reproduce\n\n1. Login to www.oppiatestserver.org\r\n2. Go to Learn- Fractions- What is a fraction\r\n3. Using keyboard tab through the lesson page \r\n4. See where the focus goes \r\n5. The focus line is seen over the content as horizontal line\n\n### Expected Behavior\n\nfocus should go only to the accessible items\n\n### Screenshots/Videos\n\n![image](https://user-images.githubusercontent.com/101634267/233531924-640f8120-16db-4c66-a4c2-18fe197ed619.png)\r\n\n\n### What device are you using?\n\nDesktop\n\n### Operating System\n\nOther\n\n### What browsers are you seeing the problem on?\n\nChrome\n\n### Browser version\n\n110.0.5481.112\n\n### Additional context\n\n_No response_",
  "issue_comments": [
    {
      "id": 1837366371,
      "user": "keyingye",
      "body": "Hi, I noticed that this issue hasn't been worked on for a while and it doesn't seem like it has been resolved. I was wondering if I could take on this issue? "
    },
    {
      "id": 1837379452,
      "user": "keyingye",
      "body": "Hello, just a follow up, I tried to fix the issue with the extra horizontal line by adjusting tabindex on the HTML so that it would not be tabbed into. Here's a video preview of the solution after editing the code. \r\n\r\nhttps://github.com/oppia/oppia/assets/74212842/57e2df4a-d027-4260-abda-396c79ee2ffb\r\n\r\n"
    },
    {
      "id": 1837505120,
      "user": "seanlip",
      "body": "@keyingye Could you please explain in more detail why the original bug occurred, what code changes you did to fix it, and why those code changes work? Thanks."
    },
    {
      "id": 1837921002,
      "user": "keyingye",
      "body": "hi @seanlip,\r\nIt seems that the original occurred because there was the option to be able to use the tab key to access the entirety of the audio menu and header component, which takes up the entire window width when it should just be the dropdown menu. \r\nTo fix this issue, we looked at the HTML for the page and noticed that the error seems to lie within the div that deals with the audio-menu and audio-header. Looking into the code aspect, we found that the audio-bar.component.html file deals with these components. We found that deleting the tabindex=\"0\" tag removes users from being able to tab into that entire div as an option which fixes the issue of the unneeded horizontal line that appears. This fix would not cause any issues because users are already able to tab into the audio dropdown such as the audio headphones and expand icons."
    },
    {
      "id": 1838955417,
      "user": "seanlip",
      "body": "Sounds good, I've assigned you; go for it!\r\n\r\nEDIT: Though if you're picking issues in future, please pick ones labelled Impact:Medium/High instead. Thanks!"
    },
    {
      "id": 1839716465,
      "user": "keyingye",
      "body": "EDIT: Nevermind, we were able to figure out the issues we were having and should be able to make a pull request soon!\r\n\r\nHi, thanks! This is my first project, so I wanted to start with something smaller but I'll definitely look into the higher impact issues!\r\n\r\nI had a question in regards to making a PR. I was following the steps for making a pull request and was trying to make a commit to my branch, but ran into an error: ModuleNotFoundError: No module named 'PIL'\r\n\r\nWould you be able to provide some assistance with this? Thank you!\r\n"
    },
    {
      "id": 2168451874,
      "user": "HardikGoyal2003",
      "body": "Unassigning @keyingye due to inactivity."
    },
    {
      "id": 2168614491,
      "user": "HardikGoyal2003",
      "body": "In core/templates/pages/exploration-player-page/layout-directives/audio-bar.component.html\r\n```\r\n<div tabindex=\"0\" aria-label=\"audio menu\" class=\"audio-header\" *ngIf=\"isAudioBarAvailable()\"\r\n     [ngClass]=\"{'audio-header-margin': explorationPlayerModeIsActive}\" headroom>\r\n```\r\n\r\nRemove ``tabindex=\"0\"`` to avoid getting focused.\r\n\r\n@seanlip Please verify. Thanks!"
    },
    {
      "id": 2173580481,
      "user": "seanlip",
      "body": "~@HardikGoyal2003 What analysis have you done to confirm whether this approach is correct?~\r\n\r\nEDIT: Sorry, I misunderstood the question -- Hardik was asking about the wording, not the correctness (which he has already checked). I think this is fine in terms of explaining what to do!"
    },
    {
      "id": 2173597187,
      "user": "github-actions[bot]",
      "body": "Hi @HardikGoyal2003, thanks for proposing this as a good first issue. I am removing the label for now and looping in @DubeySandeep to approve the label. It will be added back if approved. Thanks!"
    },
    {
      "id": 2408826771,
      "user": "KartikSuryavanshi",
      "body": "Hi @HardikGoyal2003 ,\r\n\r\nI have investigated the issue regarding the horizontal line seen while tabbing through the Fractions page. As per the proposed solution, I will remove the tabindex=\"0\" from the <div> in audio-bar.component.html to prevent it from receiving focus, thus resolving the issue.\r\n\r\nI have attached a screen recording demonstrating that the issue has been resolved.\r\n\r\nCould you please assign this issue to me for implementation?\r\n\r\nThank you!\r\n\r\nhttps://github.com/user-attachments/assets/41e5b6eb-1481-4bb6-aa10-f43c573d97d2\r\n\r\n"
    },
    {
      "id": 2408862139,
      "user": "HardikGoyal2003",
      "body": "Hey @KartikSuryavanshi Sounds good, Assigning it to you!!"
    },
    {
      "id": 2599580284,
      "user": "HardikGoyal2003",
      "body": "Closing this as fixed by https://github.com/oppia/oppia/pull/21335"
    }
  ],
  "text_context": "# [BUG]: A horizontal line is seen on the page while tabbing through the Fractions page \n\n### Describe the bug\n\nA horizontal line is seen on the page while tabbing through the Fractions page \n\n### Steps To Reproduce\n\n1. Login to www.oppiatestserver.org\r\n2. Go to Learn- Fractions- What is a fraction\r\n3. Using keyboard tab through the lesson page \r\n4. See where the focus goes \r\n5. The focus line is seen over the content as horizontal line\n\n### Expected Behavior\n\nfocus should go only to the accessible items\n\n### Screenshots/Videos\n\n![image](https://user-images.githubusercontent.com/101634267/233531924-640f8120-16db-4c66-a4c2-18fe197ed619.png)\r\n\n\n### What device are you using?\n\nDesktop\n\n### Operating System\n\nOther\n\n### What browsers are you seeing the problem on?\n\nChrome\n\n### Browser version\n\n110.0.5481.112\n\n### Additional context\n\n_No response_\n\nHi, I noticed that this issue hasn't been worked on for a while and it doesn't seem like it has been resolved. I was wondering if I could take on this issue? \n\nHello, just a follow up, I tried to fix the issue with the extra horizontal line by adjusting tabindex on the HTML so that it would not be tabbed into. Here's a video preview of the solution after editing the code. \r\n\r\nhttps://github.com/oppia/oppia/assets/74212842/57e2df4a-d027-4260-abda-396c79ee2ffb\r\n\r\n\n\n@keyingye Could you please explain in more detail why the original bug occurred, what code changes you did to fix it, and why those code changes work? Thanks.\n\nhi @seanlip,\r\nIt seems that the original occurred because there was the option to be able to use the tab key to access the entirety of the audio menu and header component, which takes up the entire window width when it should just be the dropdown menu. \r\nTo fix this issue, we looked at the HTML for the page and noticed that the error seems to lie within the div that deals with the audio-menu and audio-header. Looking into the code aspect, we found that the audio-bar.component.html file deals with these components. We found that deleting the tabindex=\"0\" tag removes users from being able to tab into that entire div as an option which fixes the issue of the unneeded horizontal line that appears. This fix would not cause any issues because users are already able to tab into the audio dropdown such as the audio headphones and expand icons.\n\nSounds good, I've assigned you; go for it!\r\n\r\nEDIT: Though if you're picking issues in future, please pick ones labelled Impact:Medium/High instead. Thanks!\n\nEDIT: Nevermind, we were able to figure out the issues we were having and should be able to make a pull request soon!\r\n\r\nHi, thanks! This is my first project, so I wanted to start with something smaller but I'll definitely look into the higher impact issues!\r\n\r\nI had a question in regards to making a PR. I was following the steps for making a pull request and was trying to make a commit to my branch, but ran into an error: ModuleNotFoundError: No module named 'PIL'\r\n\r\nWould you be able to provide some assistance with this? Thank you!\r\n\n\nUnassigning @keyingye due to inactivity.\n\nIn core/templates/pages/exploration-player-page/layout-directives/audio-bar.component.html\r\n```\r\n<div tabindex=\"0\" aria-label=\"audio menu\" class=\"audio-header\" *ngIf=\"isAudioBarAvailable()\"\r\n     [ngClass]=\"{'audio-header-margin': explorationPlayerModeIsActive}\" headroom>\r\n```\r\n\r\nRemove ``tabindex=\"0\"`` to avoid getting focused.\r\n\r\n@seanlip Please verify. Thanks!\n\n~@HardikGoyal2003 What analysis have you done to confirm whether this approach is correct?~\r\n\r\nEDIT: Sorry, I misunderstood the question -- Hardik was asking about the wording, not the correctness (which he has already checked). I think this is fine in terms of explaining what to do!\n\nHi @HardikGoyal2003, thanks for proposing this as a good first issue. I am removing the label for now and looping in @DubeySandeep to approve the label. It will be added back if approved. Thanks!\n\nHi @HardikGoyal2003 ,\r\n\r\nI have investigated the issue regarding the horizontal line seen while tabbing through the Fractions page. As per the proposed solution, I will remove the tabindex=\"0\" from the <div> in audio-bar.component.html to prevent it from receiving focus, thus resolving the issue.\r\n\r\nI have attached a screen recording demonstrating that the issue has been resolved.\r\n\r\nCould you please assign this issue to me for implementation?\r\n\r\nThank you!\r\n\r\nhttps://github.com/user-attachments/assets/41e5b6eb-1481-4bb6-aa10-f43c573d97d2\r\n\r\n\n\nHey @KartikSuryavanshi Sounds good, Assigning it to you!!\n\nClosing this as fixed by https://github.com/oppia/oppia/pull/21335",
  "pr_link": "https://github.com/oppia/oppia/pull/21335",
  "code_context": [
    {
      "filename": "core/templates/pages/exploration-player-page/layout-directives/audio-bar.component.html",
      "content": "<div aria-label=\"audio menu\" class=\"audio-header\" *ngIf=\"isAudioBarAvailable()\"\n     [ngClass]=\"{'audio-header-margin': explorationPlayerModeIsActive}\" headroom>\n\n  <div *ngIf=\"audioBarIsExpanded\" class=\"audio-bar-expanded\" headroom>\n    <div class=\"audio-controls\" [ngClass]=\"{'audio-controls-margin': progressBarIsShown}\">\n      <div class=\"oppia-audio-header-control-buttons fx-row fx-main-center fx-cross-center\">\n        <div class=\"audio-header-control-icons\">\n          <a (click)=\"onBackwardButtonClicked()\">\n            <span class=\"oppia-replay-white-circle\" *ngIf=\"progressBarIsShown\">\n              <i class=\"fas fa-undo audio-undo-icon\"></i>\n              <span class=\"oppia-five-icon\">5</span>\n            </span>\n          </a>\n          <a (click)=\"onPlayButtonClicked()\" (keydown.enter)=\"onPlayButtonClicked()\"\n             [ngbTooltip]=\"!isAudioAvailableInCurrentLanguage() ? ('I18N_PLAYER_AUDIO_NOT_AVAILABLE_IN' | translate:{languageDescription:getCurrentAudioLanguageDescription()}) : ''\"\n             placement=\"right\">\n            <i class=\"fas oppia-audio-controls-button-icon\" tabindex=\"0\" aria-label=\"Press enter to Listen to the Lesson\"\n               [ngClass]=\"{'fa-ellipsis-h': audioLoadingIndicatorIsShown, 'fa-play-circle e2e-test-play-circle': !isAudioPlaying(), 'fa-pause-circle e2e-test-pause-circle': isAudioPlaying(), 'audio-controls-audio-not-available': !isAudioAvailableInCurrentLanguage() || audioIsLoading}\">\n            </i>\n          </a>\n          <a (click)=\"onForwardButtonClicked()\">\n            <span class=\"oppia-replay-white-circle oppia-replay-white-circle-forward\" *ngIf=\"progressBarIsShown\">\n              <i class=\"fas fa-undo audio-undo-icon audio-undo-icon-forward\"></i>\n              <span class=\"oppia-five-icon oppia-five-icon-forward\">5</span>\n            </span>\n          </a>\n        </div>\n        <div class=\"slider-section\" *ngIf=\"progressBarIsShown\">\n          <div *ngIf=\"audioLoadingIndicatorIsShown\">\n            <mat-progress-bar mode=\"indeterminate\"></mat-progress-bar>\n          </div>\n          <div *ngIf=\"!audioLoadingIndicatorIsShown\">\n            <oppia-audio-slider [value]=\"this.currentVoiceoverTime\"\n                                [dir]=\"isLanguageRTL() ? 'rtl' : 'ltr'\"\n                                [max]=\"audioPlayerService.getAudioDuration()\"\n                                (valueChange)=\"setProgress($event)\"\n                                aria-label=\"audio-slider\">\n            </oppia-audio-slider>\n          </div>\n          <span *ngIf=\"audioLoadingIndicatorIsShown && !doesCurrentAudioTranslationNeedUpdate()\"\n                class=\"audio-controls-message\">\n            {{ 'I18N_PLAYER_AUDIO_LOADING_AUDIO' | translate }}\n          </span>\n          <span *ngIf=\"isAudioAvailableInCurrentLanguage() && doesCurrentAudioTranslationNeedUpdate()\"\n                class=\"audio-controls-message\">\n            {{ 'I18N_PLAYER_AUDIO_MIGHT_NOT_MATCH_TEXT' | translate }}\n          </span>\n          <!--Filler space for message-->\n          <span class=\"audio-controls-message\">&zwnj;</span>\n        </div>\n        <div class=\"oppia-audio-header-select\"\n             *ngIf=\"!isVoiceoverContributionWithAccentEnabled()\">\n          <select class=\"audio-language-select e2e-test-audio-lang-select\"\n                  [(ngModel)]=\"selectedLanguage.value\"\n                  (change)=\"onNewLanguageSelected()\">\n            <option *ngFor=\"let opt of languagesInExploration\" [value]=\"opt.value\">{{ opt.displayed }}</option>\n          </select>\n        </div>\n        <div class=\"oppia-audio-header-select\"\n             *ngIf=\"isVoiceoverContributionWithAccentEnabled() && languageAccentDecriptions.length > 0\">\n          <select class=\"audio-language-select e2e-test-audio-lang-select\"\n                  [(ngModel)]=\"selectedLanguageAccentDescription\"\n                  (change)=\"updateSelectedLanguageAccent()\">\n            <option *ngFor=\"let opt of languageAccentDecriptions\" [value]=\"opt\">{{ opt }}</option>\n          </select>\n        </div>\n      </div>\n    </div>\n    <div class=\"audio-collapse-button audio-toggle-button\"\n         *ngIf=\"audioBarIsExpanded\"\n         (click)=\"collapseAudioBar()\"\n         aria-label=\"Audio menu collapse\"\n         [ngClass]=\"{'audio-controls-margin': progressBarIsShown}\">\n      <i class=\"fas fa-sort-up\"></i>\n    </div>\n  </div>\n  <div class=\"audio-expand-button audio-toggle-button\"\n       *ngIf=\"!audioBarIsExpanded\"\n       (click)=\"expandAudioBar()\"\n       (keydown.enter)=\"expandAudioBar()\"\n       aria-label=\"Audio menu expand\">\n    <div class=\"container e2e-test-audio-bar\">\n      <div class=\"row\">\n        <div class=\"col-lg-6 px-0 mt-1 ml-2\">\n          <span class=\"audio-expand-button-text\">\n            {{ 'I18N_PLAYER_AUDIO_EXPAND_TEXT' | translate }}\n          </span>\n        </div>\n        <div class=\"col-lg-3 col-6 px-0 mt-lg-2\">\n          <i tabindex=\"0\" aria-label=\"headphone icon\" class=\"audio-expand-icon fas fa-headphones-alt\"></i>\n        </div>\n        <div class=\"col-lg-2 col-6 px-0 mt-lg-1\">\n          <i tabindex=\"0\" aria-label=\"Press Enter to expand the audio menu\" class=\"audio-expand-icon fas fa-sort-down\"></i>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<style>\n  .fa-play-circle:before {\n    font-size: 1.7em;\n  }\n\n  .fa-pause-circle:before {\n    font-size: 1.7em;\n  }\n\n  .mat-progress-bar {\n    height: 5px;\n  }\n\n  .mat-progress-bar .mat-progress-bar-fill {\n    background-color: #009688;\n  }\n\n  .mat-progress-bar-primary:after {\n    background-color: #009688;\n    border-color: #009688;\n  }\n\n  .audio-header .fa-sort-up, .audio-header .fa-sort-down {\n    transform: translateY(-2px);\n  }\n\n  .audio-expand-button {\n    height: 45px;\n    width: 150px;\n  }\n\n  @media screen and (max-width: 991px) {\n    .audio-expand-button {\n      height: 32px;\n      width: 90px;\n    }\n    .audio-expand-button-text {\n      display: none;\n    }\n  }\n\n  .audio-expand-icon {\n    font-size: 25px;\n  }\n\n  .audio-collapse-button {\n    height: 10px;\n    position: absolute;\n    top: 44px;\n    transition: top 200ms linear;\n    width: 30px;\n  }\n\n  .audio-toggle-button {\n    background-color: #0d48a1;\n    border-bottom-left-radius: 15px;\n    border-bottom-right-radius: 15px;\n    color: white;\n    display: block;\n    font-size: 12px;\n    margin: 0 auto;\n    position: sticky;\n    text-align: center;\n  }\n\n  .oppia-audio-controls-button-icon {\n    color: white;\n    font-size: 1.4em;\n    min-width: 6%;\n    text-align: right;\n    vertical-align: middle;\n  }\n  .oppia-audio-header-control-buttons {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    width: 700px;\n  }\n  .oppia-replay-white-circle {\n    display: inline-block;\n    font-size: 1.4em;\n    height: 36px;\n    padding: 5px;\n    position: relative;\n    vertical-align: middle;\n    width: 36px;\n  }\n  .audio-undo-icon {\n    color: #fff;\n    left: 50%;\n    padding: 0;\n    position: absolute;\n    top: 7px;\n    transform: translateX(-43%);\n  }\n  .audio-undo-icon-forward {\n    transform: scaleX(-1) translateX(43%);\n  }\n  .oppia-audio-header-select {\n    transform: translateY(5px);\n  }\n  .oppia-five-icon {\n    bottom: 7px;\n    color: #fff;\n    font-size: 10px;\n    font-weight: 800;\n    left: 3px;\n    position: relative;\n  }\n  .oppia-five-icon-forward {\n    left: 0;\n  }\n  .audio-controls-button-image {\n    height: 21px;\n    width: 21px;\n  }\n\n  .audio-controls-audio-not-available {\n    color: gray;\n  }\n\n  .audio-controls {\n    align-items: center;\n    background-color: #0d48a1;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    height: 70px;\n    justify-content: center;\n    padding: 0 4px;\n    transition: margin-top 200ms linear;\n    width: 100%;\n  }\n\n  .audio-controls.ng-enter,\n  .audio-controls.ng-leave {\n    position: absolute;\n    -webkit-transition: 300ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;\n    -moz-transition: 300ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;\n    -ms-transition: 300ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;\n    -o-transition: 300ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;\n    transition: 300ms cubic-bezier(0.250, 0.250, 0.750, 0.750) all;\n  }\n\n  .audio-controls.ng-enter {\n    top: -44px;\n  }\n\n  .audio-controls.ng-enter.audio-controls.ng-enter-active {\n    top: 0;\n  }\n\n  .audio-controls.ng-leave {\n    top: 0;\n  }\n\n  .audio-controls.ng-leave.audio-controls.ng-leave-active {\n    top: -44px;\n  }\n\n  .audio-controls-message {\n    color: white;\n    font-size: 10px;\n    font-style: italic;\n    vertical-align: 29px;\n  }\n\n  .audio-header {\n    left: 0;\n    position: fixed;\n    text-align: center;\n    top: 126px;\n    width: 100%;\n    z-index: 100;\n  }\n\n  .audio-header-margin {\n    top: 3.5em;\n  }\n\n  @media(max-width: 768px) {\n    .audio-header {\n      top: 3.5em;\n      transition: top 200ms linear;\n    }\n\n    .audio-header.headroom--unpinned {\n      top: 0;\n    }\n  }\n  .audio-language-select {\n    border-radius: 9px;\n    font-size: 15px;\n    margin-bottom: 15px;\n    margin-left: 5px;\n    padding-left: 2px;\n    padding-top: 2px;\n  }\n\n  .slider-section {\n    line-height: 0px;\n    transform: translateY(10px);\n  }\n\n  .audio-bar-nav-up {\n    margin-top: -186px;\n  }\n\n  .audio-bar-nav-hidden {\n    margin-top: -270px;\n  }\n\n  @media screen and (max-width: 370px) {\n    .oppia-audio-header-control-buttons {\n      justify-content: space-evenly;\n    }\n    .oppia-replay-white-circle {\n      padding: 5px;\n      width: 26px;\n    }\n    .oppia-audio-header-select select {\n      width: 100%;\n    }\n    .audio-header-control-icons {\n      order: 2;\n    }\n    .slider-section {\n      order: 1;\n      width: 90%;\n    }\n    .oppia-audio-header-select {\n      order: 3;\n      width: 50%;\n    }\n    .audio-collapse-button {\n      top: 80px;\n    }\n    .audio-controls {\n      height: 80px;\n    }\n  }\n\n  @media screen and (max-width: 550px) {\n    .audio-controls {\n      height: auto;\n      margin-top: -1px;\n      padding: 20px 0;\n      padding-right: 20px;\n    }\n    .slider-section {\n      transform: translateY(4px);\n    }\n    .audio-collapse-button {\n      top: 98px;\n    }\n    .audio-header-control-icons {\n      display: flex;\n      flex-wrap: wrap;\n      justify-content: space-between;\n    }\n    .oppia-audio-controls-button-icon {\n      font-size: 1.1em;\n      margin: 0 20px;\n      position: relative;\n      top: 4px;\n    }\n  }\n</style>\n"
    }
  ]
}