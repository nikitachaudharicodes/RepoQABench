{
  "repo_name": "scikit-learn_scikit-learn",
  "issue_id": "24876",
  "issue_description": "# `FutureWarning`s in the documentation\n\n### Describe the issue linked to the documentation\r\n\r\nSome `FutureWarning`s are present in the dev documentation and need to be fixed.\r\nHere is a list:\r\n\r\n - [x] [bicluster/plot_bicluster_newsgroups.html](https://scikit-learn.org/dev/auto_examples/bicluster/plot_bicluster_newsgroups.html)\r\n - [x] [cluster/plot_bisect_kmeans.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_bisect_kmeans.html) #24891\r\n - [x] [decomposition/plot_ica_blind_source_separation.html](https://scikit-learn.org/dev/auto_examples/decomposition/plot_ica_blind_source_separation.html) #24908\r\n - [x] [ensemble/plot_gradient_boosting_categorical.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_categorical.html) #24902\r\n - [x] [cluster/plot_color_quantization.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html) #24893\r\n - [x] [ensemble/plot_stack_predictors.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_stack_predictors.html) #24918\r\n - [x] [inspection/plot_linear_model_coefficient_interpretation.html](https://scikit-learn.org/dev/auto_examples/inspection/plot_linear_model_coefficient_interpretation.html) #24920\r\n - [x] [~~cross_decomposition/plot_compare_cross_decomposition.html~~](https://scikit-learn.org/dev/auto_examples/cross_decomposition/plot_compare_cross_decomposition.html)\r\n - [x] [cluster/plot_cluster_comparison.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_cluster_comparison.html) #24927\r\n - [x] [model_selection/plot_successive_halving_heatmap.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_successive_halving_heatmap.html) #24968\r\n - [x] [manifold/plot_compare_methods.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_compare_methods.html) #24909\r\n - [x] [cluster/plot_kmeans_assumptions.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_kmeans_assumptions.html) #24928\r\n - [x] [decomposition/plot_faces_decomposition.html](https://scikit-learn.org/dev/auto_examples/decomposition/plot_faces_decomposition.html) #24936\r\n - [x] [ensemble/plot_gradient_boosting_oob.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_oob.html) #24948\r\n - [x] [ensemble/plot_gradient_boosting_regression.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_regression.html) #24946\r\n - [x] [ensemble/plot_gradient_boosting_regularization.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_regularization.html) #24960\r\n - [x] [manifold/plot_manifold_sphere.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_manifold_sphere.html) #24941\r\n - [x] [manifold/plot_lle_digits.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_lle_digits.html) #24922\r\n - [x] [manifold/plot_mds.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_mds.html) #24940\r\n - [x] [cluster/plot_dict_face_patches.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_dict_face_patches.html) #24910\r\n - [x] [release_highlights/plot_release_highlights_0_23_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_0_23_0.html) #24937\r\n - [x] [release_highlights/plot_release_highlights_1_1_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_1_1_0.html) #24939\r\n - [x] ~~[model_selection/plot_grid_search_text_feature_extraction.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_grid_search_text_feature_extraction.html)~~ https://github.com/scikit-learn/scikit-learn/pull/24961\r\n - [x] [cluster/plot_kmeans_silhouette_analysis.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_kmeans_silhouette_analysis.html) #24929\r\n - [x] [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html) #24892\r\n\r\nContributors willing to address this issue, please offer one example per pull request.\r\n\r\nThanks for your help!\r\n\r\n### Suggest a potential alternative/fix\r\n\r\n_No response_",
  "issue_comments": [
    {
      "id": 1309799501,
      "user": "Ti-Ion",
      "body": "Hi, may I work on [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html)?"
    },
    {
      "id": 1310010274,
      "user": "ArturoAmorQ",
      "body": "> Hi, may I work on [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html)?\r\n\r\nSure, feel free to open a PR mentioning this issue :)"
    },
    {
      "id": 1310464646,
      "user": "GeorgiaMayDay",
      "body": "Sorry, this is my first time contributing to sci-learn. When you say fix, should we make it so the future warnings are accurate and change the defaults? Or instead address the TODO's in the code and then remove the warnings?\r\n\r\nSo, in the case of [`https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html`](cluster/plot_color_quantization.htm) - should I:\r\n- Change default_n_init to 10\r\nor\r\n- Fix it so default_n_init is set by auto"
    },
    {
      "id": 1310593129,
      "user": "ArturoAmorQ",
      "body": "> Sorry, this is my first time contributing to sci-learn. When you say fix, should we make it so the future warnings are accurate and change the defaults? Or instead address the TODO's in the code and then remove the warnings?\r\n\r\nYou have to change the code of each given example so that the warning is no longer raised. In the case of [`cluster/plot_color_quantization.html`](https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html) the message says\r\n```python-warning\r\nSet the value of `n_init` explicitly to suppress the warning.\r\n```\r\nSo the thing to do is to set `n_init=5` explicitly, i.e.\r\n```diff\r\nprint(\"Fitting model on a small sub-sample of the data\")\r\nt0 = time()\r\nimage_array_sample = shuffle(image_array, random_state=0, n_samples=1_000)\r\n- kmeans = KMeans(n_clusters=n_colors, random_state=0).fit(image_array_sample)\r\n+ kmeans = KMeans(n_clusters=n_colors, n_init=\"auto\", random_state=0).fit(image_array_sample)\r\nprint(f\"done in {time() - t0:0.3f}s.\")\r\n```\r\n\r\n"
    },
    {
      "id": 1312253502,
      "user": "aditya-anulekh",
      "body": "Submitted a PR to fix `FutureWarning` in `examples/cluster/plot_bisect_kmeans.py`"
    },
    {
      "id": 1312258111,
      "user": "DhanshreeA",
      "body": "Working on `ensemble/plot_gradient_boosting_categorical.html`"
    },
    {
      "id": 1313162479,
      "user": "Ti-Ion",
      "body": "Working on `cluster/plot_dict_face_patches.html`"
    },
    {
      "id": 1313957988,
      "user": "SarahRemus",
      "body": "Working on `inspection/plot_linear_model_coefficient_interpretation.html`"
    },
    {
      "id": 1315257160,
      "user": "Reddragonemperor58",
      "body": "Working on [cross_decomposition/plot_compare_cross_decomposition.html](https://scikit-learn.org/dev/auto_examples/cross_decomposition/plot_compare_cross_decomposition.html)"
    },
    {
      "id": 1315301012,
      "user": "Reddragonemperor58",
      "body": "Hi @ArturoAmorQ I am working on cross_decomposition and I found the future warning i.e., \"**_/srv/conda/envs/notebook/lib/python3.9/site-packages/sklearn/cross_decomposition/_pls.py:503: FutureWarning: The attribute `coef_` will be transposed in version 1.3 to be consistent with other linear models in scikit-learn. Currently, `coef_` has a shape of (n_features, n_targets) and in the future, it will have a shape of (n_targets, n_features).\r\n  warnings.warn(_**\" \r\n\r\nThis warning cannot be suppressed by changing anything from the code in documentation, I think we need to edit the **main** file of **_'_coef__'_** from here: https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/cross_decomposition/_pls.py\r\n\r\nIn line number **504** we need to make changes. Or we can just suppress it by using _**simplefilter**_.\r\nCould you confirm it?"
    },
    {
      "id": 1315324169,
      "user": "ArturoAmorQ",
      "body": "> This warning cannot be suppressed by changing anything from the code in documentation, I think we need to edit the **main** file of **_'_coef__'_** from here: [`main`/sklearn/cross_decomposition/_pls.py](https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/cross_decomposition/_pls.py?rgh-link-date=2022-11-15T13%3A18%3A25Z)\r\n> \r\n> In line number **504** we need to make changes. Or we can just suppress it by using _**simplefilter**_. Could you confirm it?\r\n\r\nChanging the [`coef_` function](https://github.com/scikit-learn/scikit-learn/blob/bfcb5a400efcfc82483bc0e2f233214c63b9157e/sklearn/cross_decomposition/_pls.py?rgh-link-date=2022-11-15T13%3A18%3A25Z#L496) is a TODO for version 1.3, so this should not be changed for the moment. I think it's better not to change the example either.\r\n\r\nWe will have to keep this particular example in mind. Thanks for the report @Reddragonemperor58 !\r\n"
    },
    {
      "id": 1315326825,
      "user": "Reddragonemperor58",
      "body": "Welcome, you could remove it from the list."
    },
    {
      "id": 1315425041,
      "user": "jpangas",
      "body": "Working on `decomposition/plot_faces_decomposition.html`"
    },
    {
      "id": 1315467370,
      "user": "Reddragonemperor58",
      "body": "working on [model_selection/plot_successive_halving_heatmap.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_successive_halving_heatmap.html)"
    },
    {
      "id": 1315480877,
      "user": "Reddragonemperor58",
      "body": "Hey @ArturoAmorQ for [model_selection/plot_successive_halving_heatmap.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_successive_halving_heatmap.html) the warning raised is \"In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)\" is it okay to suppress the warning using ignore as they did it in [pandas issue](https://github.com/pandas-dev/pandas/issues/45858) ?"
    },
    {
      "id": 1315489154,
      "user": "edenies",
      "body": "Working on [release_highlights/plot_release_highlights_0_23_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_0_23_0.html)"
    },
    {
      "id": 1315510166,
      "user": "Reddragonemperor58",
      "body": "working on [manifold/plot_manifold_sphere.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_manifold_sphere.html)"
    },
    {
      "id": 1315514649,
      "user": "edenies",
      "body": "Working on [release_highlights/plot_release_highlights_1_1_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_1_1_0.html)"
    },
    {
      "id": 1315594335,
      "user": "Reddragonemperor58",
      "body": "working on [ensemble/plot_gradient_boosting_regularization.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_regularization.html)"
    },
    {
      "id": 1317577703,
      "user": "isaac-chung",
      "body": "Working on [model_selection/plot_grid_search_text_feature_extraction.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_grid_search_text_feature_extraction.html)"
    },
    {
      "id": 1322203679,
      "user": "ArturoAmorQ",
      "body": "Thanks to everyone who contributed on this issue!"
    }
  ],
  "text_context": "# `FutureWarning`s in the documentation\n\n### Describe the issue linked to the documentation\r\n\r\nSome `FutureWarning`s are present in the dev documentation and need to be fixed.\r\nHere is a list:\r\n\r\n - [x] [bicluster/plot_bicluster_newsgroups.html](https://scikit-learn.org/dev/auto_examples/bicluster/plot_bicluster_newsgroups.html)\r\n - [x] [cluster/plot_bisect_kmeans.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_bisect_kmeans.html) #24891\r\n - [x] [decomposition/plot_ica_blind_source_separation.html](https://scikit-learn.org/dev/auto_examples/decomposition/plot_ica_blind_source_separation.html) #24908\r\n - [x] [ensemble/plot_gradient_boosting_categorical.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_categorical.html) #24902\r\n - [x] [cluster/plot_color_quantization.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html) #24893\r\n - [x] [ensemble/plot_stack_predictors.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_stack_predictors.html) #24918\r\n - [x] [inspection/plot_linear_model_coefficient_interpretation.html](https://scikit-learn.org/dev/auto_examples/inspection/plot_linear_model_coefficient_interpretation.html) #24920\r\n - [x] [~~cross_decomposition/plot_compare_cross_decomposition.html~~](https://scikit-learn.org/dev/auto_examples/cross_decomposition/plot_compare_cross_decomposition.html)\r\n - [x] [cluster/plot_cluster_comparison.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_cluster_comparison.html) #24927\r\n - [x] [model_selection/plot_successive_halving_heatmap.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_successive_halving_heatmap.html) #24968\r\n - [x] [manifold/plot_compare_methods.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_compare_methods.html) #24909\r\n - [x] [cluster/plot_kmeans_assumptions.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_kmeans_assumptions.html) #24928\r\n - [x] [decomposition/plot_faces_decomposition.html](https://scikit-learn.org/dev/auto_examples/decomposition/plot_faces_decomposition.html) #24936\r\n - [x] [ensemble/plot_gradient_boosting_oob.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_oob.html) #24948\r\n - [x] [ensemble/plot_gradient_boosting_regression.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_regression.html) #24946\r\n - [x] [ensemble/plot_gradient_boosting_regularization.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_regularization.html) #24960\r\n - [x] [manifold/plot_manifold_sphere.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_manifold_sphere.html) #24941\r\n - [x] [manifold/plot_lle_digits.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_lle_digits.html) #24922\r\n - [x] [manifold/plot_mds.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_mds.html) #24940\r\n - [x] [cluster/plot_dict_face_patches.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_dict_face_patches.html) #24910\r\n - [x] [release_highlights/plot_release_highlights_0_23_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_0_23_0.html) #24937\r\n - [x] [release_highlights/plot_release_highlights_1_1_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_1_1_0.html) #24939\r\n - [x] ~~[model_selection/plot_grid_search_text_feature_extraction.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_grid_search_text_feature_extraction.html)~~ https://github.com/scikit-learn/scikit-learn/pull/24961\r\n - [x] [cluster/plot_kmeans_silhouette_analysis.html](https://scikit-learn.org/dev/auto_examples/cluster/plot_kmeans_silhouette_analysis.html) #24929\r\n - [x] [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html) #24892\r\n\r\nContributors willing to address this issue, please offer one example per pull request.\r\n\r\nThanks for your help!\r\n\r\n### Suggest a potential alternative/fix\r\n\r\n_No response_\n\nHi, may I work on [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html)?\n\n> Hi, may I work on [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html)?\r\n\r\nSure, feel free to open a PR mentioning this issue :)\n\nSorry, this is my first time contributing to sci-learn. When you say fix, should we make it so the future warnings are accurate and change the defaults? Or instead address the TODO's in the code and then remove the warnings?\r\n\r\nSo, in the case of [`https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html`](cluster/plot_color_quantization.htm) - should I:\r\n- Change default_n_init to 10\r\nor\r\n- Fix it so default_n_init is set by auto\n\n> Sorry, this is my first time contributing to sci-learn. When you say fix, should we make it so the future warnings are accurate and change the defaults? Or instead address the TODO's in the code and then remove the warnings?\r\n\r\nYou have to change the code of each given example so that the warning is no longer raised. In the case of [`cluster/plot_color_quantization.html`](https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html) the message says\r\n```python-warning\r\nSet the value of `n_init` explicitly to suppress the warning.\r\n```\r\nSo the thing to do is to set `n_init=5` explicitly, i.e.\r\n```diff\r\nprint(\"Fitting model on a small sub-sample of the data\")\r\nt0 = time()\r\nimage_array_sample = shuffle(image_array, random_state=0, n_samples=1_000)\r\n- kmeans = KMeans(n_clusters=n_colors, random_state=0).fit(image_array_sample)\r\n+ kmeans = KMeans(n_clusters=n_colors, n_init=\"auto\", random_state=0).fit(image_array_sample)\r\nprint(f\"done in {time() - t0:0.3f}s.\")\r\n```\r\n\r\n\n\nSubmitted a PR to fix `FutureWarning` in `examples/cluster/plot_bisect_kmeans.py`\n\nWorking on `ensemble/plot_gradient_boosting_categorical.html`\n\nWorking on `cluster/plot_dict_face_patches.html`\n\nWorking on `inspection/plot_linear_model_coefficient_interpretation.html`\n\nWorking on [cross_decomposition/plot_compare_cross_decomposition.html](https://scikit-learn.org/dev/auto_examples/cross_decomposition/plot_compare_cross_decomposition.html)\n\nHi @ArturoAmorQ I am working on cross_decomposition and I found the future warning i.e., \"**_/srv/conda/envs/notebook/lib/python3.9/site-packages/sklearn/cross_decomposition/_pls.py:503: FutureWarning: The attribute `coef_` will be transposed in version 1.3 to be consistent with other linear models in scikit-learn. Currently, `coef_` has a shape of (n_features, n_targets) and in the future, it will have a shape of (n_targets, n_features).\r\n  warnings.warn(_**\" \r\n\r\nThis warning cannot be suppressed by changing anything from the code in documentation, I think we need to edit the **main** file of **_'_coef__'_** from here: https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/cross_decomposition/_pls.py\r\n\r\nIn line number **504** we need to make changes. Or we can just suppress it by using _**simplefilter**_.\r\nCould you confirm it?\n\n> This warning cannot be suppressed by changing anything from the code in documentation, I think we need to edit the **main** file of **_'_coef__'_** from here: [`main`/sklearn/cross_decomposition/_pls.py](https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/cross_decomposition/_pls.py?rgh-link-date=2022-11-15T13%3A18%3A25Z)\r\n> \r\n> In line number **504** we need to make changes. Or we can just suppress it by using _**simplefilter**_. Could you confirm it?\r\n\r\nChanging the [`coef_` function](https://github.com/scikit-learn/scikit-learn/blob/bfcb5a400efcfc82483bc0e2f233214c63b9157e/sklearn/cross_decomposition/_pls.py?rgh-link-date=2022-11-15T13%3A18%3A25Z#L496) is a TODO for version 1.3, so this should not be changed for the moment. I think it's better not to change the example either.\r\n\r\nWe will have to keep this particular example in mind. Thanks for the report @Reddragonemperor58 !\r\n\n\nWelcome, you could remove it from the list.\n\nWorking on `decomposition/plot_faces_decomposition.html`\n\nworking on [model_selection/plot_successive_halving_heatmap.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_successive_halving_heatmap.html)\n\nHey @ArturoAmorQ for [model_selection/plot_successive_halving_heatmap.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_successive_halving_heatmap.html) the warning raised is \"In a future version, the Index constructor will not infer numeric dtypes when passed object-dtype sequences (matching Series behavior)\" is it okay to suppress the warning using ignore as they did it in [pandas issue](https://github.com/pandas-dev/pandas/issues/45858) ?\n\nWorking on [release_highlights/plot_release_highlights_0_23_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_0_23_0.html)\n\nworking on [manifold/plot_manifold_sphere.html](https://scikit-learn.org/dev/auto_examples/manifold/plot_manifold_sphere.html)\n\nWorking on [release_highlights/plot_release_highlights_1_1_0.html](https://scikit-learn.org/dev/auto_examples/release_highlights/plot_release_highlights_1_1_0.html)\n\nworking on [ensemble/plot_gradient_boosting_regularization.html](https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_regularization.html)\n\nWorking on [model_selection/plot_grid_search_text_feature_extraction.html](https://scikit-learn.org/dev/auto_examples/model_selection/plot_grid_search_text_feature_extraction.html)\n\nThanks to everyone who contributed on this issue!",
  "pr_link": "https://github.com/scikit-learn/scikit-learn/pull/24961",
  "code_context": [
    {
      "filename": "examples/model_selection/plot_grid_search_text_feature_extraction.py",
      "content": "\"\"\"\n==========================================================\nSample pipeline for text feature extraction and evaluation\n==========================================================\n\nThe dataset used in this example is :ref:`20newsgroups_dataset` which will be\nautomatically downloaded, cached and reused for the document classification\nexample.\n\nIn this example, we tune the hyperparameters of a particular classifier using a\n:class:`~sklearn.model_selection.RandomizedSearchCV`. For a demo on the\nperformance of some other classifiers, see the\n:ref:`sphx_glr_auto_examples_text_plot_document_classification_20newsgroups.py`\nnotebook.\n\"\"\"\n\n# Author: Olivier Grisel <olivier.grisel@ensta.org>\n#         Peter Prettenhofer <peter.prettenhofer@gmail.com>\n#         Mathieu Blondel <mathieu@mblondel.org>\n#         Arturo Amor <david-arturo.amor-quiroz@inria.fr>\n# License: BSD 3 clause\n\n# %%\n# Data loading\n# ------------\n# We load two categories from the training set. You can adjust the number of\n# categories by adding their names to the list or setting `categories=None` when\n# calling the dataset loader :func:`~sklearn.datasets.fetch20newsgroups` to get\n# the 20 of them.\n\nfrom sklearn.datasets import fetch_20newsgroups\n\ncategories = [\n    \"alt.atheism\",\n    \"talk.religion.misc\",\n]\n\ndata_train = fetch_20newsgroups(\n    subset=\"train\",\n    categories=categories,\n    shuffle=True,\n    random_state=42,\n    remove=(\"headers\", \"footers\", \"quotes\"),\n)\n\ndata_test = fetch_20newsgroups(\n    subset=\"test\",\n    categories=categories,\n    shuffle=True,\n    random_state=42,\n    remove=(\"headers\", \"footers\", \"quotes\"),\n)\n\nprint(f\"Loading 20 newsgroups dataset for {len(data_train.target_names)} categories:\")\nprint(data_train.target_names)\nprint(f\"{len(data_train.data)} documents\")\n\n# %%\n# Pipeline with hyperparameter tuning\n# -----------------------------------\n#\n# We define a pipeline combining a text feature vectorizer with a simple\n# classifier yet effective for text classification.\n\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.naive_bayes import ComplementNB\nfrom sklearn.pipeline import Pipeline\n\npipeline = Pipeline(\n    [\n        (\"vect\", TfidfVectorizer()),\n        (\"clf\", ComplementNB(force_alpha=True)),\n    ]\n)\npipeline\n\n# %%\n# We define a grid of hyperparameters to be explored by the\n# :class:`~sklearn.model_selection.RandomizedSearchCV`. Using a\n# :class:`~sklearn.model_selection.GridSearchCV` instead would explore all the\n# possible combinations on the grid, which can be costly to compute, whereas the\n# parameter `n_iter` of the :class:`~sklearn.model_selection.RandomizedSearchCV`\n# controls the number of different random combination that are evaluated. Notice\n# that setting `n_iter` larger than the number of possible combinations in a\n# grid would lead to repeating already-explored combinations. We search for the\n# best parameter combination for both the feature extraction (`vect__`) and the\n# classifier (`clf__`).\n\nimport numpy as np\n\nparameter_grid = {\n    \"vect__max_df\": (0.2, 0.4, 0.6, 0.8, 1.0),\n    \"vect__min_df\": (1, 3, 5, 10),\n    \"vect__ngram_range\": ((1, 1), (1, 2)),  # unigrams or bigrams\n    \"vect__norm\": (\"l1\", \"l2\"),\n    \"clf__alpha\": np.logspace(-6, 6, 13),\n}\n\n# %%\n# In this case `n_iter=40` is not an exhaustive search of the hyperparameters'\n# grid. In practice it would be interesting to increase the parameter `n_iter`\n# to get a more informative analysis. As a consequence, the computional time\n# increases. We can reduce it by taking advantage of the parallelisation over\n# the parameter combinations evaluation by increasing the number of CPUs used\n# via the parameter `n_jobs`.\n\nfrom pprint import pprint\nfrom sklearn.model_selection import RandomizedSearchCV\n\nrandom_search = RandomizedSearchCV(\n    estimator=pipeline,\n    param_distributions=parameter_grid,\n    n_iter=40,\n    random_state=0,\n    n_jobs=2,\n    verbose=1,\n)\n\nprint(\"Performing grid search...\")\nprint(\"Hyperparameters to be evaluated:\")\npprint(parameter_grid)\n\n# %%\nfrom time import time\n\nt0 = time()\nrandom_search.fit(data_train.data, data_train.target)\nprint(f\"Done in {time() - t0:.3f}s\")\n\n# %%\nprint(\"Best parameters combination found:\")\nbest_parameters = random_search.best_estimator_.get_params()\nfor param_name in sorted(parameter_grid.keys()):\n    print(f\"{param_name}: {best_parameters[param_name]}\")\n\n# %%\ntest_accuracy = random_search.score(data_test.data, data_test.target)\nprint(\n    \"Accuracy of the best parameters using the inner CV of \"\n    f\"the random search: {random_search.best_score_:.3f}\"\n)\nprint(f\"Accuracy on test set: {test_accuracy:.3f}\")\n\n# %%\n# The prefixes `vect` and `clf` are required to avoid possible ambiguities in\n# the pipeline, but are not necessary for visualizing the results. Because of\n# this, we define a function that will rename the tuned hyperparameters and\n# improve the readability.\n\nimport pandas as pd\n\n\ndef shorten_param(param_name):\n    \"\"\"Remove components' prefixes in param_name.\"\"\"\n    if \"__\" in param_name:\n        return param_name.rsplit(\"__\", 1)[1]\n    return param_name\n\n\ncv_results = pd.DataFrame(random_search.cv_results_)\ncv_results = cv_results.rename(shorten_param, axis=1)\n\n# %%\n# We can use a `plotly.express.scatter\n# <https://plotly.com/python-api-reference/generated/plotly.express.scatter.html>`_\n# to visualize the trade-off between scoring time and mean test score (i.e. \"CV\n# score\"). Passing the cursor over a given point displays the corresponding\n# parameters. Error bars correspond to one standard deviation as computed in the\n# different folds of the cross-validation.\n\nimport plotly.express as px\n\nparam_names = [shorten_param(name) for name in parameter_grid.keys()]\nlabels = {\n    \"mean_score_time\": \"CV Score time (s)\",\n    \"mean_test_score\": \"CV score (accuracy)\",\n}\nfig = px.scatter(\n    cv_results,\n    x=\"mean_score_time\",\n    y=\"mean_test_score\",\n    error_x=\"std_score_time\",\n    error_y=\"std_test_score\",\n    hover_data=param_names,\n    labels=labels,\n)\nfig.update_layout(\n    title={\n        \"text\": \"trade-off between scoring time and mean test score\",\n        \"y\": 0.95,\n        \"x\": 0.5,\n        \"xanchor\": \"center\",\n        \"yanchor\": \"top\",\n    }\n)\nfig\n\n# %%\n# Notice that the cluster of models in the upper-left corner of the plot have\n# the best trade-off between accuracy and scoring time. In this case, using\n# bigrams increases the required scoring time without improving considerably the\n# accuracy of the pipeline.\n#\n# .. note:: For more information on how to customize an automated tuning to\n#    maximize score and minimize scoring time, see the example notebook\n#    :ref:`sphx_glr_auto_examples_model_selection_plot_grid_search_digits.py`.\n#\n# We can also use a `plotly.express.parallel_coordinates\n# <https://plotly.com/python-api-reference/generated/plotly.express.parallel_coordinates.html>`_\n# to further visualize the mean test score as a function of the tuned\n# hyperparameters. This helps finding interactions between more than two\n# hyperparameters and provide intuition on their relevance for improving the\n# performance of a pipeline.\n#\n# We apply a `math.log10` transformation on the `alpha` axis to spread the\n# active range and improve the readability of the plot. A value :math:`x` on\n# said axis is to be understood as :math:`10^x`.\n\nimport math\n\ncolumn_results = param_names + [\"mean_test_score\", \"mean_score_time\"]\n\ntransform_funcs = dict.fromkeys(column_results, lambda x: x)\n# Using a logarithmic scale for alpha\ntransform_funcs[\"alpha\"] = math.log10\n# L1 norms are mapped to index 1, and L2 norms to index 2\ntransform_funcs[\"norm\"] = lambda x: 2 if x == \"l2\" else 1\n# Unigrams are mapped to index 1 and bigrams to index 2\ntransform_funcs[\"ngram_range\"] = lambda x: x[1]\n\nfig = px.parallel_coordinates(\n    cv_results[column_results].apply(transform_funcs),\n    color=\"mean_test_score\",\n    color_continuous_scale=px.colors.sequential.Viridis_r,\n    labels=labels,\n)\nfig.update_layout(\n    title={\n        \"text\": \"Parallel coordinates plot of text classifier pipeline\",\n        \"y\": 0.99,\n        \"x\": 0.5,\n        \"xanchor\": \"center\",\n        \"yanchor\": \"top\",\n    }\n)\nfig\n\n# %%\n# The parallel coordinates plot displays the values of the hyperparameters on\n# different columns while the performance metric is color coded. It is possible\n# to select a range of results by clicking and holding on any axis of the\n# parallel coordinate plot. You can then slide (move) the range selection and\n# cross two selections to see the intersections. You can undo a selection by\n# clicking once again on the same axis.\n#\n# In particular for this hyperparameter search, it is interesting to notice that\n# the top performing models do not seem to depend on the regularization `norm`,\n# but they do depend on a trade-off between `max_df`, `min_df` and the\n# regularization strength `alpha`. The reason is that including noisy features\n# (i.e. `max_df` close to :math:`1.0` or `min_df` close to :math:`0`) tend to\n# overfit and therefore require a stronger regularization to compensate. Having\n# less features require less regularization and less scoring time.\n#\n# The best accuracy scores are obtained when `alpha` is between :math:`10^{-6}`\n# and :math:`10^0`, regardless of the hyperparameter `norm`.\n"
    }
  ],
  "questions": [
    "Hi, may I work on [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html)?",
    "> Hi, may I work on [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html)?\r\n\r\nSure, feel free to open a PR mentioning this issue :)",
    "Sorry, this is my first time contributing to sci-learn. When you say fix, should we make it so the future warnings are accurate and change the defaults? Or instead address the TODO's in the code and then remove the warnings?\r\n\r\nSo, in the case of [`https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html`](cluster/plot_color_quantization.htm) - should I:\r\n- Change default_n_init to 10\r\nor\r\n- Fix it so default_n_init is set by auto",
    "Hi @ArturoAmorQ I am working on cross_decomposition and I found the future warning i.e., \"**_/srv/conda/envs/notebook/lib/python3.9/site-packages/sklearn/cross_decomposition/_pls.py:503: FutureWarning: The attribute `coef_` will be transposed in version 1.3 to be consistent with other linear models in scikit-learn. Currently, `coef_` has a shape of (n_features, n_targets) and in the future, it will have a shape of (n_targets, n_features).\r\n  warnings.warn(_**\" \r\n\r\nThis warning cannot be suppressed by changing anything from the code in documentation, I think we need to edit the **main** file of **_'_coef__'_** from here: https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/cross_decomposition/_pls.py\r\n\r\nIn line number **504** we need to make changes. Or we can just suppress it by using _**simplefilter**_.\r\nCould you confirm it?"
  ],
  "golden_answers": [
    "> Hi, may I work on [applications/plot_cyclical_feature_engineering.html](https://scikit-learn.org/dev/auto_examples/applications/plot_cyclical_feature_engineering.html)?\r\n\r\nSure, feel free to open a PR mentioning this issue :)",
    "Sorry, this is my first time contributing to sci-learn. When you say fix, should we make it so the future warnings are accurate and change the defaults? Or instead address the TODO's in the code and then remove the warnings?\r\n\r\nSo, in the case of [`https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html`](cluster/plot_color_quantization.htm) - should I:\r\n- Change default_n_init to 10\r\nor\r\n- Fix it so default_n_init is set by auto",
    "> Sorry, this is my first time contributing to sci-learn. When you say fix, should we make it so the future warnings are accurate and change the defaults? Or instead address the TODO's in the code and then remove the warnings?\r\n\r\nYou have to change the code of each given example so that the warning is no longer raised. In the case of [`cluster/plot_color_quantization.html`](https://scikit-learn.org/dev/auto_examples/cluster/plot_color_quantization.html) the message says\r\n```python-warning\r\nSet the value of `n_init` explicitly to suppress the warning.\r\n```\r\nSo the thing to do is to set `n_init=5` explicitly, i.e.\r\n```diff\r\nprint(\"Fitting model on a small sub-sample of the data\")\r\nt0 = time()\r\nimage_array_sample = shuffle(image_array, random_state=0, n_samples=1_000)\r\n- kmeans = KMeans(n_clusters=n_colors, random_state=0).fit(image_array_sample)\r\n+ kmeans = KMeans(n_clusters=n_colors, n_init=\"auto\", random_state=0).fit(image_array_sample)\r\nprint(f\"done in {time() - t0:0.3f}s.\")\r\n```",
    "> This warning cannot be suppressed by changing anything from the code in documentation, I think we need to edit the **main** file of **_'_coef__'_** from here: [`main`/sklearn/cross_decomposition/_pls.py](https://github.com/scikit-learn/scikit-learn/blob/main/sklearn/cross_decomposition/_pls.py?rgh-link-date=2022-11-15T13%3A18%3A25Z)\r\n> \r\n> In line number **504** we need to make changes. Or we can just suppress it by using _**simplefilter**_. Could you confirm it?\r\n\r\nChanging the [`coef_` function](https://github.com/scikit-learn/scikit-learn/blob/bfcb5a400efcfc82483bc0e2f233214c63b9157e/sklearn/cross_decomposition/_pls.py?rgh-link-date=2022-11-15T13%3A18%3A25Z#L496) is a TODO for version 1.3, so this should not be changed for the moment. I think it's better not to change the example either.\r\n\r\nWe will have to keep this particular example in mind. Thanks for the report @Reddragonemperor58 !"
  ],
  "questions_generated": [
    "What is the primary issue identified in the scikit-learn repository documentation, and which files are affected?",
    "Why is it important to address 'FutureWarning's in the documentation of a library like scikit-learn?",
    "Can you describe the process or steps contributors should follow when addressing these 'FutureWarning's in the scikit-learn documentation?",
    "What might be some challenges that contributors face when fixing 'FutureWarning's in the scikit-learn documentation, and how can they overcome them?",
    "What is the role of 'RandomizedSearchCV' in the provided code example, and why is it used in the context of text feature extraction?",
    "How does the scikit-learn example code handle data loading for the 20 Newsgroups dataset, and what are some of the parameters used in this process?",
    "What potential benefits do developers and users gain from resolving 'FutureWarning's in the scikit-learn documentation?"
  ],
  "golden_answers_generated": [
    "The primary issue identified in the scikit-learn repository documentation is the presence of 'FutureWarning's. These warnings indicate that certain features or functions used in the provided examples may become obsolete or change in future versions of the library. The affected files include various example scripts, such as 'bicluster/plot_bicluster_newsgroups.html', 'cluster/plot_bisect_kmeans.html', 'decomposition/plot_ica_blind_source_separation.html', and several others.",
    "'FutureWarning's are important to address because they indicate potential changes or deprecations in future versions of the library. If not resolved, these warnings can lead to outdated or broken examples, which can confuse users and hinder the learning process. Maintaining updated documentation ensures that users can rely on the examples provided to learn and implement machine learning models effectively.",
    "Contributors addressing 'FutureWarning's should first identify the specific cause of the warning in each example script. They should then update the code to use the recommended alternatives or adjustments suggested by the warning message. Since each fix should be submitted as a separate pull request, contributors should ensure that their changes are isolated and well-documented. Testing the modified examples to confirm that the warnings are resolved without introducing new issues is also essential.",
    "Contributors might face challenges such as understanding the underlying cause of the 'FutureWarning', especially if it involves deprecated features or complex dependencies. They may also need to ensure that the new code is compatible with both current and future versions of scikit-learn. To overcome these challenges, contributors can refer to the official scikit-learn release notes and documentation for guidance on deprecated features and recommended practices. Engaging with the community through issue discussions or seeking help from maintainers can also provide valuable insights.",
    "'RandomizedSearchCV' is used in the provided code example as a hyperparameter tuning tool. It performs a random search over specified parameter values for a given estimator, which in this case is a classifier for text data. In the context of text feature extraction, 'RandomizedSearchCV' helps efficiently explore the hyperparameter space to find the optimal settings that improve model performance, especially when dealing with high-dimensional data like text.",
    "The scikit-learn example code handles data loading for the 20 Newsgroups dataset using the 'fetch_20newsgroups' function. It specifies parameters like 'subset' to select either 'train' or 'test' data, 'categories' to filter specific newsgroups, 'shuffle' to randomize the data order, and 'random_state' for reproducibility. The 'remove' parameter is used to exclude certain parts of the text, such as headers, footers, and quotes, to focus on the content of the messages.",
    "By resolving 'FutureWarning's in the scikit-learn documentation, developers and users benefit from up-to-date and reliable examples that reflect the latest best practices. This ensures that users can learn and apply machine learning techniques without encountering deprecated features that could lead to errors in future releases. It also helps maintain the overall quality and trustworthiness of the library, encouraging broader adoption and contributing to the community's growth."
  ]
}